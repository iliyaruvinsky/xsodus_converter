DROP VIEW SAPABAP1.CV_CNCLD_EVNTS CASCADE;
CREATE VIEW SAPABAP1.CV_CNCLD_EVNTS AS
WITH
  ctleqr AS (
    SELECT * FROM (
      SELECT
          SAPABAP1.ZBW_CTL_HD_RE.BUSOBJ_TYPE AS BUSOBJ_TYPE,
          SAPABAP1.ZBW_CTL_HD_RE.CONTROL_MODEL AS CONTROL_MODEL,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPROCESS_STAT AS ZZPROCESS_STAT,
          SAPABAP1.ZBW_CTL_HD_RE.STT_CTRL AS STT_CTRL,
          SAPABAP1.ZBW_CTL_HD_RE.MANDT AS MANDT,
          SAPABAP1.ZBW_CTL_HD_RE.REM_RATE AS REM_RATE,
          SAPABAP1.ZBW_CTL_HD_RE.REM_LEDAMNT AS REM_LEDAMNT,
          SAPABAP1.ZBW_CTL_HD_RE.ZZJOB AS ZZJOB,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSK AS ZZPERSK,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSG AS ZZPERSG,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERNR AS ZZPERNR,
          SAPABAP1.ZBW_CTL_HD_RE.ZZJOBGRP AS ZZJOBGRP,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSA AS ZZPERSA,
          SAPABAP1.ZBW_CTL_HD_RE.ZZEYRULTB AS ZZEYRULTB,
          SAPABAP1.ZBW_CTL_HD_RE.PERID AS PERID,
          SAPABAP1.ZBW_CTL_HD_RE.SOURCE AS SOURCE,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_MEDC_CD AS ZZTREAT_MEDC_CD,
          SAPABAP1.ZBW_CTL_HD_RE.ZZMEMBERID AS ZZMEMBERID,
          SAPABAP1.ZBW_CTL_HD_RE.REMUNERATION AS REMUNERATION,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_DATE AS ZZTREAT_DATE,
          SAPABAP1.ZBW_CTL_HD_RE.CTRTBU_ID AS CTRTBU_ID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_COMM_CD AS ZZTREAT_COMM_CD,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_NO_BW AS ZZTREAT_NO_BW,
          SAPABAP1.ZBW_CTL_HD_RE.BUSOBJ_ID AS BUSOBJ_ID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZ_FA_T_QUOTA AS ZZ_FA_T_QUOTA,
          SAPABAP1.ZBW_CTL_HD_RE.ZZZPOSITION AS ZZZPOSITION,
          SAPABAP1.ZBW_CTL_HD_RE.GPART AS GPART,
          SUBSTRING("ZZTREAT_DATE", 1, 4) AS CALYEAR,
          SUBSTRING("ZZTREAT_DATE", 1, 6) AS CALMONTH,
          CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '01' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '02' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '03') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'1' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '04' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '05' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '06') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'2' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '07' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '08' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '09') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'3' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '10' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '11' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '12') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'4' ELSE NULL END END END END AS CALQUARTER,
          'מאושר בבקרה' AS VARIANT
      FROM SAPABAP1.ZBW_CTL_HD_RE
    ) AS calc
    WHERE (calc."BUSOBJ_TYPE" = 'ZMR' AND calc."CONTROL_MODEL" = 'Z02' AND (calc."ZZPROCESS_STAT" = 'R' OR calc."ZZPROCESS_STAT" = 'M') AND (calc."STT_CTRL" = 'AA' OR calc."STT_CTRL" = 'AM') AND ('''' = '' OR calc."ZZTREAT_DATE" = '''') AND ('''' = '' OR calc."PERID" = '''') AND ('''' = '' OR calc."ZZZPOSITION" = '''') AND ('''' = '' OR calc."ZZ_FA_T_QUOTA" = '''') AND ('''' = '' OR '''' = calc."CALMONTH") AND ('''' = '' OR '''' = calc."CALQUARTER") AND ( '''' = '' OR '''' = calc."CALYEAR"))
  ),
  ctleqa AS (
    SELECT * FROM (
      SELECT
          SAPABAP1.ZBW_CTL_HD_RE.CONTROL_MODEL AS CONTROL_MODEL,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPROCESS_STAT AS ZZPROCESS_STAT,
          SAPABAP1.ZBW_CTL_HD_RE.STT_CTRL AS STT_CTRL,
          SAPABAP1.ZBW_CTL_HD_RE.BUSOBJ_ID AS BUSOBJ_ID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_NO_BW AS ZZTREAT_NO_BW,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_COMM_CD AS ZZTREAT_COMM_CD,
          SAPABAP1.ZBW_CTL_HD_RE.CTRTBU_ID AS CTRTBU_ID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZZPOSITION AS ZZZPOSITION,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_DATE AS ZZTREAT_DATE,
          SAPABAP1.ZBW_CTL_HD_RE.REMUNERATION AS REMUNERATION,
          SAPABAP1.ZBW_CTL_HD_RE.ZZMEMBERID AS ZZMEMBERID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_MEDC_CD AS ZZTREAT_MEDC_CD,
          SAPABAP1.ZBW_CTL_HD_RE.SOURCE AS SOURCE,
          SAPABAP1.ZBW_CTL_HD_RE.PERID AS PERID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZEYRULTB AS ZZEYRULTB,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSA AS ZZPERSA,
          SAPABAP1.ZBW_CTL_HD_RE.ZZJOBGRP AS ZZJOBGRP,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERNR AS ZZPERNR,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSG AS ZZPERSG,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSK AS ZZPERSK,
          SAPABAP1.ZBW_CTL_HD_RE.ZZJOB AS ZZJOB,
          SAPABAP1.ZBW_CTL_HD_RE.REM_RATE AS REM_RATE,
          SAPABAP1.ZBW_CTL_HD_RE.REM_LEDAMNT AS REM_LEDAMNT,
          SAPABAP1.ZBW_CTL_HD_RE.ZZ_FA_T_QUOTA AS ZZ_FA_T_QUOTA,
          SAPABAP1.ZBW_CTL_HD_RE.GPART AS GPART,
          SUBSTRING("ZZTREAT_DATE", 1, 4) AS CALYEAR,
          SUBSTRING("ZZTREAT_DATE", 1, 6) AS CALMONTH,
          CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '01' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '02' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '03') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'1' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '04' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '05' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '06') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'2' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '07' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '08' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '09') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'3' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '10' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '11' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '12') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'4' ELSE NULL END END END END AS CALQUARTER,
          'דחוי בבקרה' AS VARIANT
      FROM SAPABAP1.ZBW_CTL_HD_RE
    ) AS calc
    WHERE (calc."CONTROL_MODEL" = 'Z02' AND (calc."ZZPROCESS_STAT" = 'A' OR calc."ZZPROCESS_STAT" = 'M') AND (calc."STT_CTRL" = 'RA' OR calc."STT_CTRL" = 'RM') AND ('''' = '' OR calc."ZZTREAT_DATE" = '''') AND ('''' = '' OR calc."PERID" = '''') AND ('''' = '' OR calc."ZZZPOSITION" = '''') AND ('''' = '' OR calc."ZZ_FA_T_QUOTA" = '''') AND ('''' = '' OR '''' = calc."CALMONTH") AND ('''' = '' OR '''' = calc."CALQUARTER") AND ( '''' = '' OR '''' = calc."CALYEAR"))
  ),
  ctleqm AS (
    SELECT * FROM (
      SELECT
          SAPABAP1.ZBW_CTL_HD_RE.CONTROL_MODEL AS CONTROL_MODEL,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPROCESS_STAT AS ZZPROCESS_STAT,
          SAPABAP1.ZBW_CTL_HD_RE.STT_CTRL AS STT_CTRL,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_NO_BW AS ZZTREAT_NO_BW,
          SAPABAP1.ZBW_CTL_HD_RE.BUSOBJ_ID AS BUSOBJ_ID,
          SAPABAP1.ZBW_CTL_HD_RE.REMUNERATION AS REMUNERATION,
          SAPABAP1.ZBW_CTL_HD_RE.ZZ_FA_T_QUOTA AS ZZ_FA_T_QUOTA,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_COMM_CD AS ZZTREAT_COMM_CD,
          SAPABAP1.ZBW_CTL_HD_RE.REM_RATE AS REM_RATE,
          SAPABAP1.ZBW_CTL_HD_RE.REM_LEDAMNT AS REM_LEDAMNT,
          SAPABAP1.ZBW_CTL_HD_RE.SOURCE AS SOURCE,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_DATE AS ZZTREAT_DATE,
          SAPABAP1.ZBW_CTL_HD_RE.PERID AS PERID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZMEMBERID AS ZZMEMBERID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZEYRULTB AS ZZEYRULTB,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSA AS ZZPERSA,
          SAPABAP1.ZBW_CTL_HD_RE.ZZJOBGRP AS ZZJOBGRP,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERNR AS ZZPERNR,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSG AS ZZPERSG,
          SAPABAP1.ZBW_CTL_HD_RE.ZZPERSK AS ZZPERSK,
          SAPABAP1.ZBW_CTL_HD_RE.ZZJOB AS ZZJOB,
          SAPABAP1.ZBW_CTL_HD_RE.CTRTBU_ID AS CTRTBU_ID,
          SAPABAP1.ZBW_CTL_HD_RE.ZZZPOSITION AS ZZZPOSITION,
          SAPABAP1.ZBW_CTL_HD_RE.ZZTREAT_MEDC_CD AS ZZTREAT_MEDC_CD,
          SAPABAP1.ZBW_CTL_HD_RE.GPART AS GPART,
          SUBSTRING("ZZTREAT_DATE", 1, 4) AS CALYEAR,
          SUBSTRING("ZZTREAT_DATE", 1, 6) AS CALMONTH,
          CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '01' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '02' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '03') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'1' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '04' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '05' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '06') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'2' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '07' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '08' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '09') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'3' ELSE CASE WHEN (RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '10' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '11' OR RIGHT((SUBSTRING("ZZTREAT_DATE", 1, 6)), 2) = '12') THEN SUBSTRING("ZZTREAT_DATE", 1, 4)+'4' ELSE NULL END END END END AS CALQUARTER,
          'ממתין בבקרה' AS VARIANT
      FROM SAPABAP1.ZBW_CTL_HD_RE
    ) AS calc
    WHERE (calc."CONTROL_MODEL" = 'Z02' AND (calc."ZZPROCESS_STAT" = 'A' OR calc."ZZPROCESS_STAT" = 'R') AND (calc."STT_CTRL" = 'HA' OR calc."STT_CTRL" = 'HM' OR calc."STT_CTRL" = 'MA' OR calc."STT_CTRL" = 'MM') AND ('''' = '' OR calc."ZZTREAT_DATE" = '''') AND ('''' = '' OR calc."PERID" = '''') AND ('''' = '' OR calc."ZZZPOSITION" = '''') AND ('''' = '' OR calc."ZZ_FA_T_QUOTA" = '''') AND ('''' = '' OR '''' = calc."CALMONTH") AND ('''' = '' OR '''' = calc."CALQUARTER") AND ( '''' = '' OR '''' = calc."CALYEAR"))
  ),
  union_1 AS (
    SELECT
        ctleqr.BUSOBJ_TYPE AS BUSOBJ_TYPE,
        ctleqr.CONTROL_MODEL AS CONTROL_MODEL,
        ctleqr.ZZPROCESS_STAT AS ZZPROCESS_STAT,
        ctleqr.STT_CTRL AS STT_CTRL,
        ctleqr.MANDT AS MANDT,
        ctleqr.REM_RATE AS REM_RATE,
        ctleqr.REM_LEDAMNT AS REM_LEDAMNT,
        ctleqr.ZZJOB AS ZZJOB,
        ctleqr.ZZPERSK AS ZZPERSK,
        ctleqr.ZZPERSG AS ZZPERSG,
        ctleqr.ZZPERNR AS ZZPERNR,
        ctleqr.ZZJOBGRP AS ZZJOBGRP,
        ctleqr.ZZPERSA AS ZZPERSA,
        ctleqr.ZZEYRULTB AS ZZEYRULTB,
        ctleqr.PERID AS PERID,
        ctleqr.SOURCE AS SOURCE,
        ctleqr.ZZTREAT_MEDC_CD AS ZZTREAT_MEDC_CD,
        ctleqr.ZZMEMBERID AS ZZMEMBERID,
        ctleqr.REMUNERATION AS REMUNERATION,
        ctleqr.ZZTREAT_DATE AS ZZTREAT_DATE,
        ctleqr.CTRTBU_ID AS CTRTBU_ID,
        ctleqr.ZZTREAT_COMM_CD AS ZZTREAT_COMM_CD,
        ctleqr.ZZTREAT_NO_BW AS ZZTREAT_NO_BW,
        ctleqr.BUSOBJ_ID AS BUSOBJ_ID,
        ctleqr.ZZ_FA_T_QUOTA AS ZZ_FA_T_QUOTA,
        ctleqr.ZZZPOSITION AS ZZZPOSITION,
        ctleqr.GPART AS GPART,
        ctleqr.VARIANT AS VARIANT,
        ctleqr.CALYEAR AS CALYEAR,
        ctleqr.CALMONTH AS CALMONTH,
        ctleqr.CALQUARTER AS CALQUARTER
    FROM ctleqr
    UNION ALL
    SELECT
        NULL AS BUSOBJ_TYPE,
        ctleqa.CONTROL_MODEL AS CONTROL_MODEL,
        ctleqa.ZZPROCESS_STAT AS ZZPROCESS_STAT,
        ctleqa.STT_CTRL AS STT_CTRL,
        NULL AS MANDT,
        ctleqa.REM_RATE AS REM_RATE,
        ctleqa.REM_LEDAMNT AS REM_LEDAMNT,
        ctleqa.ZZJOB AS ZZJOB,
        ctleqa.ZZPERSK AS ZZPERSK,
        ctleqa.ZZPERSG AS ZZPERSG,
        ctleqa.ZZPERNR AS ZZPERNR,
        ctleqa.ZZJOBGRP AS ZZJOBGRP,
        ctleqa.ZZPERSA AS ZZPERSA,
        ctleqa.ZZEYRULTB AS ZZEYRULTB,
        ctleqa.PERID AS PERID,
        ctleqa.SOURCE AS SOURCE,
        ctleqa.ZZTREAT_MEDC_CD AS ZZTREAT_MEDC_CD,
        ctleqa.ZZMEMBERID AS ZZMEMBERID,
        ctleqa.REMUNERATION AS REMUNERATION,
        ctleqa.ZZTREAT_DATE AS ZZTREAT_DATE,
        ctleqa.CTRTBU_ID AS CTRTBU_ID,
        ctleqa.ZZTREAT_COMM_CD AS ZZTREAT_COMM_CD,
        ctleqa.ZZTREAT_NO_BW AS ZZTREAT_NO_BW,
        ctleqa.BUSOBJ_ID AS BUSOBJ_ID,
        ctleqa.ZZ_FA_T_QUOTA AS ZZ_FA_T_QUOTA,
        ctleqa.ZZZPOSITION AS ZZZPOSITION,
        ctleqa.GPART AS GPART,
        ctleqa.VARIANT AS VARIANT,
        ctleqa.CALYEAR AS CALYEAR,
        ctleqa.CALMONTH AS CALMONTH,
        ctleqa.CALQUARTER AS CALQUARTER
    FROM ctleqa
    UNION ALL
    SELECT
        NULL AS BUSOBJ_TYPE,
        ctleqm.CONTROL_MODEL AS CONTROL_MODEL,
        ctleqm.ZZPROCESS_STAT AS ZZPROCESS_STAT,
        ctleqm.STT_CTRL AS STT_CTRL,
        NULL AS MANDT,
        ctleqm.REM_RATE AS REM_RATE,
        ctleqm.REM_LEDAMNT AS REM_LEDAMNT,
        ctleqm.ZZJOB AS ZZJOB,
        ctleqm.ZZPERSK AS ZZPERSK,
        ctleqm.ZZPERSG AS ZZPERSG,
        ctleqm.ZZPERNR AS ZZPERNR,
        ctleqm.ZZJOBGRP AS ZZJOBGRP,
        ctleqm.ZZPERSA AS ZZPERSA,
        ctleqm.ZZEYRULTB AS ZZEYRULTB,
        ctleqm.PERID AS PERID,
        ctleqm.SOURCE AS SOURCE,
        ctleqm.ZZTREAT_MEDC_CD AS ZZTREAT_MEDC_CD,
        ctleqm.ZZMEMBERID AS ZZMEMBERID,
        ctleqm.REMUNERATION AS REMUNERATION,
        ctleqm.ZZTREAT_DATE AS ZZTREAT_DATE,
        ctleqm.CTRTBU_ID AS CTRTBU_ID,
        ctleqm.ZZTREAT_COMM_CD AS ZZTREAT_COMM_CD,
        ctleqm.ZZTREAT_NO_BW AS ZZTREAT_NO_BW,
        ctleqm.BUSOBJ_ID AS BUSOBJ_ID,
        ctleqm.ZZ_FA_T_QUOTA AS ZZ_FA_T_QUOTA,
        ctleqm.ZZZPOSITION AS ZZZPOSITION,
        ctleqm.GPART AS GPART,
        ctleqm.VARIANT AS VARIANT,
        ctleqm.CALYEAR AS CALYEAR,
        ctleqm.CALMONTH AS CALMONTH,
        ctleqm.CALQUARTER AS CALQUARTER
    FROM ctleqm
  ),
  aggregation AS (
    SELECT
        union_1.ZZPROCESS_STAT AS ZZPROCESS_STAT,
        union_1.REMUNERATION AS REMUNERATION,
        union_1.ZZTREAT_DATE AS ZZTREAT_DATE,
        union_1.CTRTBU_ID AS CTRTBU_ID,
        union_1.ZZTREAT_COMM_CD AS ZZTREAT_COMM_CD,
        union_1.BUSOBJ_ID AS BUSOBJ_ID,
        union_1.ZZ_FA_T_QUOTA AS ZZ_FA_T_QUOTA,
        union_1.ZZZPOSITION AS ZZZPOSITION,
        union_1.GPART AS GPART,
        union_1.CALYEAR AS CALYEAR,
        union_1.CALMONTH AS CALMONTH,
        union_1.CALQUARTER AS CALQUARTER,
        union_1.VARIANT AS VARIANT,
        union_1.STT_CTRL AS STT_CTRL
    FROM union_1
    GROUP BY union_1.ZZPROCESS_STAT, union_1.REMUNERATION, union_1.ZZTREAT_DATE, union_1.CTRTBU_ID, union_1.ZZTREAT_COMM_CD, union_1.BUSOBJ_ID, union_1.ZZ_FA_T_QUOTA, union_1.ZZZPOSITION, union_1.GPART, union_1.CALYEAR, union_1.CALMONTH, union_1.CALQUARTER, union_1.VARIANT, union_1.STT_CTRL
  )

SELECT ZZPROCESS_STAT, REMUNERATION, ZZTREAT_DATE, CTRTBU_ID, ZZTREAT_COMM_CD, BUSOBJ_ID, ZZ_FA_T_QUOTA, ZZZPOSITION, GPART, CALYEAR, CALMONTH, CALQUARTER, VARIANT, STT_CTRL FROM aggregation