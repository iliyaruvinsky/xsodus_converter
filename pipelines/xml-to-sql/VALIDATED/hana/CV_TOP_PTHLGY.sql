DROP VIEW "_SYS_BIC"."Macabi_BI.EYAL.EYAL_CDS/CV_TOP_PTHLGY" CASCADE;
CREATE VIEW "_SYS_BIC"."Macabi_BI.EYAL.EYAL_CDS/CV_TOP_PTHLGY" AS
WITH
  pthlgy AS (
    SELECT
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYILABNO" AS "_BIC_EYILABNO",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATRNO" AS "_BIC_EYPATRNO",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTMEMID" AS "_BIC_EYTMEMID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMEMIDC" AS "_BIC_EYMEMIDC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDOCID" AS "_BIC_EYTDOCID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOPDLIC" AS "_BIC_EYOPDLIC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMAFDID" AS "_BIC_EYMAFDID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYDOCLIC" AS "_BIC_EYDOCLIC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYSAMDT" AS "_BIC_EYSAMDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCOLCDT" AS "_BIC_EYCOLCDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYANSDT" AS "_BIC_EYANSDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTSTTYP" AS "_BIC_EYTSTTYP",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPDFPTH" AS "_BIC_EYPDFPTH",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMALIGN" AS "_BIC_EYMALIGN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDRDAN" AS "_BIC_EYTDRDAN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODRDAN" AS "_BIC_EYODRDAN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATREV" AS "_BIC_EYPATREV",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYREPDT" AS "_BIC_EYREPDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYREPMET" AS "_BIC_EYREPMET",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYRECNAM" AS "_BIC_EYRECNAM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCOMMNT" AS "_BIC_EYCOMMNT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOREPDT" AS "_BIC_EYOREPDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOREPMT" AS "_BIC_EYOREPMT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYORECNM" AS "_BIC_EYORECNM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOCOMNT" AS "_BIC_EYOCOMNT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDANDT" AS "_BIC_EYTDANDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDANTM" AS "_BIC_EYTDANTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODANDT" AS "_BIC_EYODANDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODANTM" AS "_BIC_EYODANTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYORIGN" AS "_BIC_EYORIGN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMSNOM" AS "_BIC_EYMSNOM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTSNOM" AS "_BIC_EYTSNOM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCREATDT" AS "_BIC_EYCREATDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCREATTM" AS "_BIC_EYCREATTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYEVNTID" AS "_BIC_EYEVNTID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EZCLINSIS" AS "_BIC_EZCLINSIS",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYDOCPOS" AS "_BIC_EYDOCPOS",
        SAPABAP1."/BIC/AEYO_RW0800".EMPLGROUP AS EMPLGROUP,
        SAPABAP1."/BIC/AEYO_RW0800".EMPLSGROUP AS EMPLSGROUP,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPOSPER" AS "_BIC_EYPOSPER",
        SAPABAP1."/BIC/AEYO_RW0800".ORGUNIT AS ORGUNIT,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACTYP" AS "_BIC_EYFACTYP",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACSTYP" AS "_BIC_EYFACSTYP",
        SAPABAP1."/BIC/AEYO_RW0800".EMPLOYEE AS EMPLOYEE,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYROLE" AS "_BIC_EYROLE",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYROLEGRP" AS "_BIC_EYROLEGRP",
        SAPABAP1."/BIC/AEYO_RW0800".CALDAY AS CALDAY,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACOWNR" AS "_BIC_EYFACOWNR",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATAG" AS "_BIC_EYPATAG",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATAGC" AS "_BIC_EYPATAGC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATIENT" AS "_BIC_EYPATIENT",
        TO_DATE(SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYSAMDT") AS EYSAMDT_DT
    FROM SAPABAP1."/BIC/AEYO_RW0800"
    WHERE ("/BIC/EYPATREV" = '00' AND "/BIC/EYSAMDT" > SUBSTRING(TO_VARCHAR(TO_DATE(ADD_DAYS(CURRENT_TIMESTAMP, -365))), 1, 4) + '0101')
  ),
  pthlgy_rev_zero AS (
    SELECT
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYILABNO" AS "_BIC_EYILABNO",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATRNO" AS "_BIC_EYPATRNO",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTMEMID" AS "_BIC_EYTMEMID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMEMIDC" AS "_BIC_EYMEMIDC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDOCID" AS "_BIC_EYTDOCID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOPDLIC" AS "_BIC_EYOPDLIC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMAFDID" AS "_BIC_EYMAFDID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYDOCLIC" AS "_BIC_EYDOCLIC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYSAMDT" AS "_BIC_EYSAMDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCOLCDT" AS "_BIC_EYCOLCDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYANSDT" AS "_BIC_EYANSDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTSTTYP" AS "_BIC_EYTSTTYP",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPDFPTH" AS "_BIC_EYPDFPTH",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMALIGN" AS "_BIC_EYMALIGN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDRDAN" AS "_BIC_EYTDRDAN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODRDAN" AS "_BIC_EYODRDAN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATREV" AS "_BIC_EYPATREV",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYREPDT" AS "_BIC_EYREPDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYREPMET" AS "_BIC_EYREPMET",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYRECNAM" AS "_BIC_EYRECNAM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCOMMNT" AS "_BIC_EYCOMMNT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOREPDT" AS "_BIC_EYOREPDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOREPMT" AS "_BIC_EYOREPMT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYORECNM" AS "_BIC_EYORECNM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOCOMNT" AS "_BIC_EYOCOMNT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDANDT" AS "_BIC_EYTDANDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDANTM" AS "_BIC_EYTDANTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODANDT" AS "_BIC_EYODANDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODANTM" AS "_BIC_EYODANTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYORIGN" AS "_BIC_EYORIGN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMSNOM" AS "_BIC_EYMSNOM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTSNOM" AS "_BIC_EYTSNOM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCREATDT" AS "_BIC_EYCREATDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCREATTM" AS "_BIC_EYCREATTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYEVNTID" AS "_BIC_EYEVNTID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EZCLINSIS" AS "_BIC_EZCLINSIS",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYDOCPOS" AS "_BIC_EYDOCPOS",
        SAPABAP1."/BIC/AEYO_RW0800".EMPLGROUP AS EMPLGROUP,
        SAPABAP1."/BIC/AEYO_RW0800".EMPLSGROUP AS EMPLSGROUP,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPOSPER" AS "_BIC_EYPOSPER",
        SAPABAP1."/BIC/AEYO_RW0800".ORGUNIT AS ORGUNIT,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACTYP" AS "_BIC_EYFACTYP",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACSTYP" AS "_BIC_EYFACSTYP",
        SAPABAP1."/BIC/AEYO_RW0800".EMPLOYEE AS EMPLOYEE,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYROLE" AS "_BIC_EYROLE",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYROLEGRP" AS "_BIC_EYROLEGRP",
        SAPABAP1."/BIC/AEYO_RW0800".CALDAY AS CALDAY,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACOWNR" AS "_BIC_EYFACOWNR",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATAG" AS "_BIC_EYPATAG",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATAGC" AS "_BIC_EYPATAGC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATIENT" AS "_BIC_EYPATIENT"
    FROM SAPABAP1."/BIC/AEYO_RW0800"
    WHERE ("/BIC/EYPATREV" = '00' AND "/BIC/EYSAMDT" > SUBSTRING(TO_VARCHAR(TO_DATE(ADD_DAYS(CURRENT_TIMESTAMP, -365))), 1, 4) + '0101' AND (not (("/BIC/EYEVNTID") IS NULL) or "/BIC/EYEVNTID" != ''))
  ),
  pthlgy_rev_1_n AS (
    SELECT
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYILABNO" AS "_BIC_EYILABNO",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATRNO" AS "_BIC_EYPATRNO",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTMEMID" AS "_BIC_EYTMEMID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMEMIDC" AS "_BIC_EYMEMIDC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDOCID" AS "_BIC_EYTDOCID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOPDLIC" AS "_BIC_EYOPDLIC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMAFDID" AS "_BIC_EYMAFDID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYDOCLIC" AS "_BIC_EYDOCLIC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYSAMDT" AS "_BIC_EYSAMDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCOLCDT" AS "_BIC_EYCOLCDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYANSDT" AS "_BIC_EYANSDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTSTTYP" AS "_BIC_EYTSTTYP",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPDFPTH" AS "_BIC_EYPDFPTH",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMALIGN" AS "_BIC_EYMALIGN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDRDAN" AS "_BIC_EYTDRDAN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODRDAN" AS "_BIC_EYODRDAN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATREV" AS "_BIC_EYPATREV",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYREPDT" AS "_BIC_EYREPDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYREPMET" AS "_BIC_EYREPMET",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYRECNAM" AS "_BIC_EYRECNAM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCOMMNT" AS "_BIC_EYCOMMNT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOREPDT" AS "_BIC_EYOREPDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOREPMT" AS "_BIC_EYOREPMT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYORECNM" AS "_BIC_EYORECNM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOCOMNT" AS "_BIC_EYOCOMNT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDANDT" AS "_BIC_EYTDANDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTDANTM" AS "_BIC_EYTDANTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODANDT" AS "_BIC_EYODANDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYODANTM" AS "_BIC_EYODANTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYORIGN" AS "_BIC_EYORIGN",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYMSNOM" AS "_BIC_EYMSNOM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYTSNOM" AS "_BIC_EYTSNOM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCREATDT" AS "_BIC_EYCREATDT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYCREATTM" AS "_BIC_EYCREATTM",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYEVNTID" AS "_BIC_EYEVNTID",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EZCLINSIS" AS "_BIC_EZCLINSIS",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYDOCPOS" AS "_BIC_EYDOCPOS",
        SAPABAP1."/BIC/AEYO_RW0800".EMPLGROUP AS EMPLGROUP,
        SAPABAP1."/BIC/AEYO_RW0800".EMPLSGROUP AS EMPLSGROUP,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPOSPER" AS "_BIC_EYPOSPER",
        SAPABAP1."/BIC/AEYO_RW0800".ORGUNIT AS ORGUNIT,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACTYP" AS "_BIC_EYFACTYP",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACSTYP" AS "_BIC_EYFACSTYP",
        SAPABAP1."/BIC/AEYO_RW0800".EMPLOYEE AS EMPLOYEE,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYROLE" AS "_BIC_EYROLE",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYROLEGRP" AS "_BIC_EYROLEGRP",
        SAPABAP1."/BIC/AEYO_RW0800".CALDAY AS CALDAY,
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYFACOWNR" AS "_BIC_EYFACOWNR",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATAG" AS "_BIC_EYPATAG",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATAGC" AS "_BIC_EYPATAGC",
        SAPABAP1."/BIC/AEYO_RW0800"."/BIC/EYPATIENT" AS "_BIC_EYPATIENT"
    FROM SAPABAP1."/BIC/AEYO_RW0800"
    WHERE ("/BIC/EYPATREV" != '00' AND "/BIC/EYSAMDT" > SUBSTRING(TO_VARCHAR(TO_DATE(ADD_DAYS(CURRENT_TIMESTAMP, -365))), 1, 4) + '0101' AND ((("/BIC/EYEVNTID") IS NULL) or "/BIC/EYEVNTID" = ''))
  ),
  projection_4 AS (
    SELECT
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYEVNTID" AS "_BIC_EYEVNTID",
        SAPABAP1."/BIC/AEZO_RW0300".CALDAY AS CALDAY,
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYDOCPOS" AS "_BIC_EYDOCPOS",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYFCLTY" AS "_BIC_EYFCLTY",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYROLE" AS "_BIC_EYROLE",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYROLEGRP" AS "_BIC_EYROLEGRP",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        SAPABAP1."/BIC/AEZO_RW0300".EMPLGROUP AS EMPLGROUP,
        SAPABAP1."/BIC/AEZO_RW0300".ORGUNIT AS ORGUNIT,
        SAPABAP1."/BIC/AEZO_RW0300".EMPLSGROUP AS EMPLSGROUP,
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYFACTYP" AS "_BIC_EYFACTYP",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYFACSTYP" AS "_BIC_EYFACSTYP",
        SAPABAP1."/BIC/AEZO_RW0300".EMPLOYEE AS EMPLOYEE,
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYPATAG" AS "_BIC_EYPATAG",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYPATAGC" AS "_BIC_EYPATAGC",
        SAPABAP1."/BIC/AEZO_RW0300".G_CWW009 AS G_CWW009,
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYTRTQT" AS "_BIC_EYTRTQT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYSYSCD" AS "_BIC_EYSYSCD",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYFACOWNR" AS "_BIC_EYFACOWNR",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYEMPCLSS" AS "_BIC_EYEMPCLSS",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYTEEMNUM" AS "_BIC_EYTEEMNUM",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYTEEMTYP" AS "_BIC_EYTEEMTYP",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYILABNO" AS "_BIC_EYILABNO",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYPATRNO" AS "_BIC_EYPATRNO",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYPATREV" AS "_BIC_EYPATREV",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYSAMDT" AS "_BIC_EYSAMDT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYANSDT" AS "_BIC_EYANSDT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYODANDT" AS "_BIC_EYODANDT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYREPDT" AS "_BIC_EYREPDT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYMALIGN" AS "_BIC_EYMALIGN",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYTRTRT" AS "_BIC_EYTRTRT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYCTLN11" AS "_BIC_EYCTLN11",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYCTLN12" AS "_BIC_EYCTLN12",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYTDRDAN" AS "_BIC_EYTDRDAN",
        SAPABAP1."/BIC/AEZO_RW0300".G_CWW004 AS G_CWW004,
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYOREPDT" AS "_BIC_EYOREPDT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYDOC2ID" AS "_BIC_EYDOC2ID",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EZCLINSIS" AS "_BIC_EZCLINSIS",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYPATIENT" AS "_BIC_EYPATIENT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYMEMIDC" AS "_BIC_EYMEMIDC",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYDOC0ID" AS "_BIC_EYDOC0ID",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYTRMID" AS "_BIC_EYTRMID",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYRECSTT" AS "_BIC_EYRECSTT",
        SAPABAP1."/BIC/AEZO_RW0300"."/BIC/EYPOSPER" AS "_BIC_EYPOSPER"
    FROM SAPABAP1."/BIC/AEZO_RW0300"
    WHERE ("CALDAY" > SUBSTRING(TO_VARCHAR(TO_DATE(ADD_DAYS(CURRENT_TIMESTAMP, -365))), 1, 4) + '0101')
  ),
  projection_1 AS (
    SELECT
        SAPABAP1.ZC_GXX_TRT."/BIC/EYEVNTID" AS "_BIC_EYEVNTID",
        SAPABAP1.ZC_GXX_TRT."/BIC/EYTRTNUM" AS "_BIC_EYTRTNUM",
        SAPABAP1.ZC_GXX_TRT.CALDAY AS CALDAY,
        SAPABAP1.ZC_GXX_TRT."/BIC/EYTDOCID" AS "_BIC_EYTDOCID",
        SAPABAP1.ZC_GXX_TRT."/BIC/EYPATIENT" AS "_BIC_EYPATIENT",
        SAPABAP1.ZC_GXX_TRT."/BIC/EYMEMIDC" AS "_BIC_EYMEMIDC",
        SAPABAP1.ZC_GXX_TRT."/BIC/EYTRTCD" AS "_BIC_EYTRTCD",
        SAPABAP1.ZC_GXX_TRT."/BIC/EYRULCD" AS "_BIC_EYRULCD",
        SAPABAP1.ZC_GXX_TRT."/BIC/EYCTLT13" AS "_BIC_EYCTLT13"
    FROM SAPABAP1.ZC_GXX_TRT
    WHERE (("/BIC/EYRULCD" = 'G02' or "/BIC/EYRULCD" = 'G07' ) AND "CALDAY">= SUBSTRING(TO_VARCHAR(TO_DATE(ADD_DAYS(CURRENT_TIMESTAMP, -365))), 1, 4) + '0101')
  ),
  tsttyp_1 AS (
    SELECT
        pthlgy."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        pthlgy."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        pthlgy."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        pthlgy."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        pthlgy."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        pthlgy."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        pthlgy."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        pthlgy."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        pthlgy."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        pthlgy."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        pthlgy."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        pthlgy."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        pthlgy."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        pthlgy."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        pthlgy."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        pthlgy."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        pthlgy."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        pthlgy."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        pthlgy."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        pthlgy."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        pthlgy."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        pthlgy."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        pthlgy."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        pthlgy."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        pthlgy."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        pthlgy."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        pthlgy."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        pthlgy."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        pthlgy."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        pthlgy."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        pthlgy."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        pthlgy."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        pthlgy."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        pthlgy."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        pthlgy."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        pthlgy."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        pthlgy."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        pthlgy.EMPLGROUP AS EMPLGROUP,
        pthlgy.EMPLSGROUP AS EMPLSGROUP,
        pthlgy."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        pthlgy.ORGUNIT AS ORGUNIT,
        pthlgy."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        pthlgy."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        pthlgy.EMPLOYEE AS EMPLOYEE,
        pthlgy."_BIC_EYROLE" AS "_BIC_EYROLE",
        pthlgy."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        pthlgy.CALDAY AS CALDAY,
        pthlgy."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        pthlgy."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        pthlgy."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        pthlgy."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        pthlgy."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        pthlgy.EYSAMDT_DT AS EYSAMDT_DT
    FROM pthlgy
    WHERE ("_BIC_EYTSTTYP"=1)
  ),
  tsttyp_2 AS (
    SELECT
        pthlgy."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        pthlgy."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        pthlgy."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        pthlgy."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        pthlgy."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        pthlgy."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        pthlgy."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        pthlgy."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        pthlgy."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        pthlgy."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        pthlgy."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        pthlgy."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        pthlgy."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        pthlgy."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        pthlgy."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        pthlgy."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        pthlgy."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        pthlgy."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        pthlgy."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        pthlgy."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        pthlgy."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        pthlgy."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        pthlgy."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        pthlgy."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        pthlgy."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        pthlgy."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        pthlgy."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        pthlgy."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        pthlgy."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        pthlgy."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        pthlgy."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        pthlgy."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        pthlgy."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        pthlgy."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        pthlgy."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        pthlgy."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        pthlgy."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        pthlgy.EMPLGROUP AS EMPLGROUP,
        pthlgy.EMPLSGROUP AS EMPLSGROUP,
        pthlgy."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        pthlgy.ORGUNIT AS ORGUNIT,
        pthlgy."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        pthlgy."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        pthlgy.EMPLOYEE AS EMPLOYEE,
        pthlgy."_BIC_EYROLE" AS "_BIC_EYROLE",
        pthlgy."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        pthlgy.CALDAY AS CALDAY,
        pthlgy."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        pthlgy."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        pthlgy."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        pthlgy."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        pthlgy."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        pthlgy.EYSAMDT_DT AS EYSAMDT_DT
    FROM pthlgy
    WHERE ("_BIC_EYTSTTYP"=2)
  ),
  tsttyp_3 AS (
    SELECT
        pthlgy."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        pthlgy."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        pthlgy."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        pthlgy."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        pthlgy."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        pthlgy."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        pthlgy."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        pthlgy."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        pthlgy."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        pthlgy."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        pthlgy."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        pthlgy."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        pthlgy."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        pthlgy."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        pthlgy."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        pthlgy."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        pthlgy."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        pthlgy."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        pthlgy."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        pthlgy."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        pthlgy."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        pthlgy."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        pthlgy."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        pthlgy."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        pthlgy."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        pthlgy."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        pthlgy."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        pthlgy."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        pthlgy."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        pthlgy."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        pthlgy."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        pthlgy."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        pthlgy."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        pthlgy."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        pthlgy."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        pthlgy."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        pthlgy."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        pthlgy.EMPLGROUP AS EMPLGROUP,
        pthlgy.EMPLSGROUP AS EMPLSGROUP,
        pthlgy."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        pthlgy.ORGUNIT AS ORGUNIT,
        pthlgy."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        pthlgy."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        pthlgy.EMPLOYEE AS EMPLOYEE,
        pthlgy."_BIC_EYROLE" AS "_BIC_EYROLE",
        pthlgy."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        pthlgy.CALDAY AS CALDAY,
        pthlgy."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        pthlgy."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        pthlgy."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        pthlgy."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        pthlgy."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        pthlgy.EYSAMDT_DT AS EYSAMDT_DT
    FROM pthlgy
    WHERE ("_BIC_EYTSTTYP"=3)
  ),
  tsttyp_4 AS (
    SELECT
        pthlgy."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        pthlgy."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        pthlgy."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        pthlgy."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        pthlgy."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        pthlgy."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        pthlgy."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        pthlgy."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        pthlgy."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        pthlgy."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        pthlgy."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        pthlgy."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        pthlgy."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        pthlgy."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        pthlgy."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        pthlgy."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        pthlgy."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        pthlgy."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        pthlgy."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        pthlgy."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        pthlgy."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        pthlgy."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        pthlgy."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        pthlgy."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        pthlgy."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        pthlgy."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        pthlgy."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        pthlgy."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        pthlgy."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        pthlgy."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        pthlgy."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        pthlgy."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        pthlgy."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        pthlgy."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        pthlgy."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        pthlgy."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        pthlgy."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        pthlgy.EMPLGROUP AS EMPLGROUP,
        pthlgy.EMPLSGROUP AS EMPLSGROUP,
        pthlgy."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        pthlgy.ORGUNIT AS ORGUNIT,
        pthlgy."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        pthlgy."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        pthlgy.EMPLOYEE AS EMPLOYEE,
        pthlgy."_BIC_EYROLE" AS "_BIC_EYROLE",
        pthlgy."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        pthlgy.CALDAY AS CALDAY,
        pthlgy."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        pthlgy."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        pthlgy."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        pthlgy."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        pthlgy."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        pthlgy.EYSAMDT_DT AS EYSAMDT_DT
    FROM pthlgy
    WHERE ("_BIC_EYTSTTYP"=4)
  ),
  tsttyp_5 AS (
    SELECT
        pthlgy."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        pthlgy."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        pthlgy."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        pthlgy."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        pthlgy."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        pthlgy."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        pthlgy."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        pthlgy."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        pthlgy."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        pthlgy."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        pthlgy."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        pthlgy."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        pthlgy."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        pthlgy."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        pthlgy."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        pthlgy."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        pthlgy."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        pthlgy."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        pthlgy."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        pthlgy."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        pthlgy."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        pthlgy."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        pthlgy."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        pthlgy."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        pthlgy."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        pthlgy."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        pthlgy."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        pthlgy."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        pthlgy."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        pthlgy."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        pthlgy."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        pthlgy."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        pthlgy."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        pthlgy."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        pthlgy."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        pthlgy."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        pthlgy."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        pthlgy.EMPLGROUP AS EMPLGROUP,
        pthlgy.EMPLSGROUP AS EMPLSGROUP,
        pthlgy."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        pthlgy.ORGUNIT AS ORGUNIT,
        pthlgy."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        pthlgy."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        pthlgy.EMPLOYEE AS EMPLOYEE,
        pthlgy."_BIC_EYROLE" AS "_BIC_EYROLE",
        pthlgy."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        pthlgy.CALDAY AS CALDAY,
        pthlgy."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        pthlgy."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        pthlgy."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        pthlgy."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        pthlgy."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        pthlgy.EYSAMDT_DT AS EYSAMDT_DT
    FROM pthlgy
    WHERE ("_BIC_EYTSTTYP"=5)
  ),
  tsttyp_6 AS (
    SELECT
        pthlgy."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        pthlgy."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        pthlgy."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        pthlgy."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        pthlgy."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        pthlgy."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        pthlgy."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        pthlgy."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        pthlgy."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        pthlgy."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        pthlgy."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        pthlgy."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        pthlgy."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        pthlgy."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        pthlgy."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        pthlgy."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        pthlgy."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        pthlgy."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        pthlgy."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        pthlgy."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        pthlgy."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        pthlgy."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        pthlgy."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        pthlgy."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        pthlgy."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        pthlgy."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        pthlgy."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        pthlgy."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        pthlgy."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        pthlgy."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        pthlgy."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        pthlgy."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        pthlgy."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        pthlgy."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        pthlgy."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        pthlgy."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        pthlgy."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        pthlgy.EMPLGROUP AS EMPLGROUP,
        pthlgy.EMPLSGROUP AS EMPLSGROUP,
        pthlgy."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        pthlgy.ORGUNIT AS ORGUNIT,
        pthlgy."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        pthlgy."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        pthlgy.EMPLOYEE AS EMPLOYEE,
        pthlgy."_BIC_EYROLE" AS "_BIC_EYROLE",
        pthlgy."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        pthlgy.CALDAY AS CALDAY,
        pthlgy."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        pthlgy."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        pthlgy."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        pthlgy."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        pthlgy."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        pthlgy.EYSAMDT_DT AS EYSAMDT_DT
    FROM pthlgy
    WHERE ("_BIC_EYTSTTYP"=6)
  ),
  tsttyp_7 AS (
    SELECT
        pthlgy."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        pthlgy."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        pthlgy."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        pthlgy."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        pthlgy."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        pthlgy."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        pthlgy."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        pthlgy."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        pthlgy."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        pthlgy."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        pthlgy."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        pthlgy."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        pthlgy."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        pthlgy."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        pthlgy."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        pthlgy."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        pthlgy."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        pthlgy."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        pthlgy."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        pthlgy."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        pthlgy."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        pthlgy."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        pthlgy."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        pthlgy."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        pthlgy."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        pthlgy."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        pthlgy."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        pthlgy."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        pthlgy."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        pthlgy."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        pthlgy."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        pthlgy."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        pthlgy."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        pthlgy."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        pthlgy."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        pthlgy."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        pthlgy."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        pthlgy.EMPLGROUP AS EMPLGROUP,
        pthlgy.EMPLSGROUP AS EMPLSGROUP,
        pthlgy."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        pthlgy.ORGUNIT AS ORGUNIT,
        pthlgy."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        pthlgy."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        pthlgy.EMPLOYEE AS EMPLOYEE,
        pthlgy."_BIC_EYROLE" AS "_BIC_EYROLE",
        pthlgy."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        pthlgy.CALDAY AS CALDAY,
        pthlgy."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        pthlgy."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        pthlgy."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        pthlgy."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        pthlgy."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        pthlgy.EYSAMDT_DT AS EYSAMDT_DT
    FROM pthlgy
    WHERE ("_BIC_EYTSTTYP"=7)
  ),
  join_2 AS (
    SELECT
        pthlgy_rev_zero."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        pthlgy_rev_zero."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        pthlgy_rev_zero."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        pthlgy_rev_zero.EMPLGROUP AS EMPLGROUP,
        pthlgy_rev_zero.EMPLSGROUP AS EMPLSGROUP,
        pthlgy_rev_zero."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        pthlgy_rev_zero.ORGUNIT AS ORGUNIT,
        pthlgy_rev_zero."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        pthlgy_rev_zero."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        pthlgy_rev_zero.EMPLOYEE AS EMPLOYEE,
        pthlgy_rev_zero."_BIC_EYROLE" AS "_BIC_EYROLE",
        pthlgy_rev_zero."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        pthlgy_rev_zero.CALDAY AS CALDAY,
        pthlgy_rev_zero."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        pthlgy_rev_zero."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        pthlgy_rev_zero."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        pthlgy_rev_zero."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        pthlgy_rev_1_n."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        pthlgy_rev_1_n."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        pthlgy_rev_1_n."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        pthlgy_rev_1_n."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        pthlgy_rev_1_n."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        pthlgy_rev_1_n."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        pthlgy_rev_1_n."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        pthlgy_rev_1_n."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        pthlgy_rev_1_n."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        pthlgy_rev_1_n."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        pthlgy_rev_1_n."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        pthlgy_rev_1_n."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        pthlgy_rev_1_n."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        pthlgy_rev_1_n."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        pthlgy_rev_1_n."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        pthlgy_rev_1_n."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        pthlgy_rev_1_n."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        pthlgy_rev_1_n."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        pthlgy_rev_1_n."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        pthlgy_rev_1_n."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        pthlgy_rev_1_n."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        pthlgy_rev_1_n."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        pthlgy_rev_1_n."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        pthlgy_rev_1_n."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        pthlgy_rev_1_n."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        pthlgy_rev_1_n."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        pthlgy_rev_1_n."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        pthlgy_rev_1_n."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        pthlgy_rev_1_n."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        pthlgy_rev_1_n."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        pthlgy_rev_1_n."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        pthlgy_rev_1_n."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        pthlgy_rev_1_n."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        pthlgy_rev_1_n."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        pthlgy_rev_1_n."_BIC_EYPATIENT" AS "_BIC_EYPATIENT"
    FROM pthlgy_rev_zero
    INNER JOIN pthlgy_rev_1_n ON pthlgy_rev_zero."_BIC_EYPATRNO" = pthlgy_rev_1_n."_BIC_EYPATRNO" AND pthlgy_rev_zero."_BIC_EYPATIENT" = pthlgy_rev_1_n."_BIC_EYPATIENT" AND pthlgy_rev_zero."_BIC_EYTSTTYP" = pthlgy_rev_1_n."_BIC_EYTSTTYP"
  ),
  rank_3 AS (
    SELECT * FROM (
      SELECT
          projection_4."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          projection_4.CALDAY AS CALDAY,
          projection_4."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
          projection_4."_BIC_EYFCLTY" AS "_BIC_EYFCLTY",
          projection_4."_BIC_EYROLE" AS "_BIC_EYROLE",
          projection_4."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
          projection_4."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
          projection_4.EMPLGROUP AS EMPLGROUP,
          projection_4.ORGUNIT AS ORGUNIT,
          projection_4.EMPLSGROUP AS EMPLSGROUP,
          projection_4."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
          projection_4."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
          projection_4.EMPLOYEE AS EMPLOYEE,
          projection_4."_BIC_EYPATAG" AS "_BIC_EYPATAG",
          projection_4."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
          projection_4.G_CWW009 AS G_CWW009,
          projection_4."_BIC_EYTRTQT" AS "_BIC_EYTRTQT",
          projection_4."_BIC_EYSYSCD" AS "_BIC_EYSYSCD",
          projection_4."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
          projection_4."_BIC_EYEMPCLSS" AS "_BIC_EYEMPCLSS",
          projection_4."_BIC_EYTEEMNUM" AS "_BIC_EYTEEMNUM",
          projection_4."_BIC_EYTEEMTYP" AS "_BIC_EYTEEMTYP",
          projection_4."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          projection_4."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          projection_4."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          projection_4."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          projection_4."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          projection_4."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          projection_4."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          projection_4."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          projection_4."_BIC_EYTRTRT" AS "_BIC_EYTRTRT",
          projection_4."_BIC_EYCTLN11" AS "_BIC_EYCTLN11",
          projection_4."_BIC_EYCTLN12" AS "_BIC_EYCTLN12",
          projection_4."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          projection_4.G_CWW004 AS G_CWW004,
          projection_4."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          projection_4."_BIC_EYDOC2ID" AS "_BIC_EYDOC2ID",
          projection_4."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
          projection_4."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          projection_4."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          projection_4."_BIC_EYDOC0ID" AS "_BIC_EYDOC0ID",
          projection_4."_BIC_EYTRMID" AS "_BIC_EYTRMID",
          projection_4."_BIC_EYRECSTT" AS "_BIC_EYRECSTT",
          projection_4."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
          ROW_NUMBER() OVER (PARTITION BY projection_4."_BIC_EYEVNTID" ORDER BY projection_4."_BIC_EYEVNTID" DESC) AS RANK_COLUMN
      FROM projection_4
    ) AS ranked
    WHERE RANK_COLUMN <= 1
  ),
  aggregation_1 AS (
    SELECT
        agg_inner.*,
        CASE WHEN (agg_inner."_BIC_EYRULCD"='G02' or agg_inner."_BIC_EYRULCD"='G07') THEN '01' ELSE '02' END AS EY_CTLT1
    FROM (
      SELECT
          projection_1."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          projection_1.CALDAY AS CALDAY,
          projection_1."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          projection_1."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          projection_1."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          projection_1."_BIC_EYTRTCD" AS "_BIC_EYTRTCD",
          projection_1."_BIC_EYRULCD" AS "_BIC_EYRULCD"
      FROM projection_1
      GROUP BY projection_1."_BIC_EYEVNTID", projection_1.CALDAY, projection_1."_BIC_EYTDOCID", projection_1."_BIC_EYPATIENT", projection_1."_BIC_EYMEMIDC", projection_1."_BIC_EYTRTCD", projection_1."_BIC_EYRULCD"
    ) AS agg_inner
  ),
  rank_pthlgy_1 AS (
    SELECT * FROM (
      SELECT
          tsttyp_1."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          tsttyp_1."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          tsttyp_1."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
          tsttyp_1."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          tsttyp_1."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          tsttyp_1."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
          tsttyp_1."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
          tsttyp_1."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
          tsttyp_1."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          tsttyp_1."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
          tsttyp_1."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          tsttyp_1."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
          tsttyp_1."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
          tsttyp_1."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          tsttyp_1."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          tsttyp_1."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
          tsttyp_1."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          tsttyp_1."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          tsttyp_1."_BIC_EYREPMET" AS "_BIC_EYREPMET",
          tsttyp_1."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
          tsttyp_1."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
          tsttyp_1."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          tsttyp_1."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
          tsttyp_1."_BIC_EYORECNM" AS "_BIC_EYORECNM",
          tsttyp_1."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
          tsttyp_1."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
          tsttyp_1."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
          tsttyp_1."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          tsttyp_1."_BIC_EYODANTM" AS "_BIC_EYODANTM",
          tsttyp_1."_BIC_EYORIGN" AS "_BIC_EYORIGN",
          tsttyp_1."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
          tsttyp_1."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
          tsttyp_1."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
          tsttyp_1."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
          tsttyp_1."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          tsttyp_1."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
          tsttyp_1."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
          tsttyp_1.EMPLGROUP AS EMPLGROUP,
          tsttyp_1.EMPLSGROUP AS EMPLSGROUP,
          tsttyp_1."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
          tsttyp_1.ORGUNIT AS ORGUNIT,
          tsttyp_1."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
          tsttyp_1."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
          tsttyp_1.EMPLOYEE AS EMPLOYEE,
          tsttyp_1."_BIC_EYROLE" AS "_BIC_EYROLE",
          tsttyp_1."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
          tsttyp_1.CALDAY AS CALDAY,
          tsttyp_1."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
          tsttyp_1."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
          tsttyp_1."_BIC_EYPATAG" AS "_BIC_EYPATAG",
          tsttyp_1."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
          tsttyp_1."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          tsttyp_1.EYSAMDT_DT AS EYSAMDT_DT,
          ROW_NUMBER() OVER (PARTITION BY tsttyp_1."_BIC_EYPATIENT", tsttyp_1."_BIC_EYSAMDT" ORDER BY tsttyp_1."_BIC_EYPATRNO" DESC) AS RANK_COL_PT
      FROM tsttyp_1
    ) AS ranked
    WHERE RANK_COL_PT <= 10
  ),
  rank_pthlgy_2 AS (
    SELECT * FROM (
      SELECT
          tsttyp_2."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          tsttyp_2."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          tsttyp_2."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
          tsttyp_2."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          tsttyp_2."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          tsttyp_2."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
          tsttyp_2."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
          tsttyp_2."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
          tsttyp_2."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          tsttyp_2."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
          tsttyp_2."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          tsttyp_2."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
          tsttyp_2."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
          tsttyp_2."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          tsttyp_2."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          tsttyp_2."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
          tsttyp_2."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          tsttyp_2."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          tsttyp_2."_BIC_EYREPMET" AS "_BIC_EYREPMET",
          tsttyp_2."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
          tsttyp_2."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
          tsttyp_2."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          tsttyp_2."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
          tsttyp_2."_BIC_EYORECNM" AS "_BIC_EYORECNM",
          tsttyp_2."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
          tsttyp_2."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
          tsttyp_2."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
          tsttyp_2."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          tsttyp_2."_BIC_EYODANTM" AS "_BIC_EYODANTM",
          tsttyp_2."_BIC_EYORIGN" AS "_BIC_EYORIGN",
          tsttyp_2."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
          tsttyp_2."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
          tsttyp_2."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
          tsttyp_2."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
          tsttyp_2."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          tsttyp_2."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
          tsttyp_2."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
          tsttyp_2.EMPLGROUP AS EMPLGROUP,
          tsttyp_2.EMPLSGROUP AS EMPLSGROUP,
          tsttyp_2."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
          tsttyp_2.ORGUNIT AS ORGUNIT,
          tsttyp_2."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
          tsttyp_2."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
          tsttyp_2.EMPLOYEE AS EMPLOYEE,
          tsttyp_2."_BIC_EYROLE" AS "_BIC_EYROLE",
          tsttyp_2."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
          tsttyp_2.CALDAY AS CALDAY,
          tsttyp_2."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
          tsttyp_2."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
          tsttyp_2."_BIC_EYPATAG" AS "_BIC_EYPATAG",
          tsttyp_2."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
          tsttyp_2."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          tsttyp_2.EYSAMDT_DT AS EYSAMDT_DT,
          ROW_NUMBER() OVER (PARTITION BY tsttyp_2."_BIC_EYPATIENT", tsttyp_2."_BIC_EYSAMDT" ORDER BY tsttyp_2."_BIC_EYPATRNO" DESC) AS RANK_COL_PT
      FROM tsttyp_2
    ) AS ranked
    WHERE RANK_COL_PT <= 10
  ),
  rank_pthlgy_3 AS (
    SELECT * FROM (
      SELECT
          tsttyp_3."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          tsttyp_3."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          tsttyp_3."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
          tsttyp_3."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          tsttyp_3."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          tsttyp_3."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
          tsttyp_3."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
          tsttyp_3."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
          tsttyp_3."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          tsttyp_3."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
          tsttyp_3."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          tsttyp_3."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
          tsttyp_3."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
          tsttyp_3."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          tsttyp_3."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          tsttyp_3."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
          tsttyp_3."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          tsttyp_3."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          tsttyp_3."_BIC_EYREPMET" AS "_BIC_EYREPMET",
          tsttyp_3."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
          tsttyp_3."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
          tsttyp_3."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          tsttyp_3."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
          tsttyp_3."_BIC_EYORECNM" AS "_BIC_EYORECNM",
          tsttyp_3."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
          tsttyp_3."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
          tsttyp_3."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
          tsttyp_3."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          tsttyp_3."_BIC_EYODANTM" AS "_BIC_EYODANTM",
          tsttyp_3."_BIC_EYORIGN" AS "_BIC_EYORIGN",
          tsttyp_3."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
          tsttyp_3."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
          tsttyp_3."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
          tsttyp_3."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
          tsttyp_3."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          tsttyp_3."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
          tsttyp_3."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
          tsttyp_3.EMPLGROUP AS EMPLGROUP,
          tsttyp_3.EMPLSGROUP AS EMPLSGROUP,
          tsttyp_3."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
          tsttyp_3.ORGUNIT AS ORGUNIT,
          tsttyp_3."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
          tsttyp_3."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
          tsttyp_3.EMPLOYEE AS EMPLOYEE,
          tsttyp_3."_BIC_EYROLE" AS "_BIC_EYROLE",
          tsttyp_3."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
          tsttyp_3.CALDAY AS CALDAY,
          tsttyp_3."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
          tsttyp_3."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
          tsttyp_3."_BIC_EYPATAG" AS "_BIC_EYPATAG",
          tsttyp_3."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
          tsttyp_3."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          tsttyp_3.EYSAMDT_DT AS EYSAMDT_DT,
          ROW_NUMBER() OVER (PARTITION BY tsttyp_3."_BIC_EYPATIENT", tsttyp_3."_BIC_EYSAMDT" ORDER BY tsttyp_3."_BIC_EYPATRNO" DESC) AS RANK_COL_PT
      FROM tsttyp_3
    ) AS ranked
    WHERE RANK_COL_PT <= 10
  ),
  rank_pthlgy_4 AS (
    SELECT * FROM (
      SELECT
          tsttyp_4."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          tsttyp_4."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          tsttyp_4."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
          tsttyp_4."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          tsttyp_4."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          tsttyp_4."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
          tsttyp_4."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
          tsttyp_4."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
          tsttyp_4."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          tsttyp_4."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
          tsttyp_4."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          tsttyp_4."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
          tsttyp_4."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
          tsttyp_4."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          tsttyp_4."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          tsttyp_4."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
          tsttyp_4."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          tsttyp_4."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          tsttyp_4."_BIC_EYREPMET" AS "_BIC_EYREPMET",
          tsttyp_4."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
          tsttyp_4."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
          tsttyp_4."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          tsttyp_4."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
          tsttyp_4."_BIC_EYORECNM" AS "_BIC_EYORECNM",
          tsttyp_4."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
          tsttyp_4."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
          tsttyp_4."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
          tsttyp_4."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          tsttyp_4."_BIC_EYODANTM" AS "_BIC_EYODANTM",
          tsttyp_4."_BIC_EYORIGN" AS "_BIC_EYORIGN",
          tsttyp_4."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
          tsttyp_4."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
          tsttyp_4."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
          tsttyp_4."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
          tsttyp_4."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          tsttyp_4."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
          tsttyp_4."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
          tsttyp_4.EMPLGROUP AS EMPLGROUP,
          tsttyp_4.EMPLSGROUP AS EMPLSGROUP,
          tsttyp_4."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
          tsttyp_4.ORGUNIT AS ORGUNIT,
          tsttyp_4."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
          tsttyp_4."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
          tsttyp_4.EMPLOYEE AS EMPLOYEE,
          tsttyp_4."_BIC_EYROLE" AS "_BIC_EYROLE",
          tsttyp_4."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
          tsttyp_4.CALDAY AS CALDAY,
          tsttyp_4."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
          tsttyp_4."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
          tsttyp_4."_BIC_EYPATAG" AS "_BIC_EYPATAG",
          tsttyp_4."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
          tsttyp_4."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          tsttyp_4.EYSAMDT_DT AS EYSAMDT_DT,
          ROW_NUMBER() OVER (PARTITION BY tsttyp_4."_BIC_EYPATIENT", tsttyp_4."_BIC_EYSAMDT" ORDER BY tsttyp_4."_BIC_EYPATRNO" DESC) AS RANK_COL_PT
      FROM tsttyp_4
    ) AS ranked
    WHERE RANK_COL_PT <= 10
  ),
  rank_pthlgy_5 AS (
    SELECT * FROM (
      SELECT
          tsttyp_5."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          tsttyp_5."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          tsttyp_5."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
          tsttyp_5."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          tsttyp_5."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          tsttyp_5."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
          tsttyp_5."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
          tsttyp_5."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
          tsttyp_5."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          tsttyp_5."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
          tsttyp_5."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          tsttyp_5."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
          tsttyp_5."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
          tsttyp_5."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          tsttyp_5."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          tsttyp_5."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
          tsttyp_5."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          tsttyp_5."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          tsttyp_5."_BIC_EYREPMET" AS "_BIC_EYREPMET",
          tsttyp_5."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
          tsttyp_5."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
          tsttyp_5."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          tsttyp_5."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
          tsttyp_5."_BIC_EYORECNM" AS "_BIC_EYORECNM",
          tsttyp_5."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
          tsttyp_5."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
          tsttyp_5."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
          tsttyp_5."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          tsttyp_5."_BIC_EYODANTM" AS "_BIC_EYODANTM",
          tsttyp_5."_BIC_EYORIGN" AS "_BIC_EYORIGN",
          tsttyp_5."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
          tsttyp_5."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
          tsttyp_5."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
          tsttyp_5."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
          tsttyp_5."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          tsttyp_5."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
          tsttyp_5."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
          tsttyp_5.EMPLGROUP AS EMPLGROUP,
          tsttyp_5.EMPLSGROUP AS EMPLSGROUP,
          tsttyp_5."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
          tsttyp_5.ORGUNIT AS ORGUNIT,
          tsttyp_5."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
          tsttyp_5."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
          tsttyp_5.EMPLOYEE AS EMPLOYEE,
          tsttyp_5."_BIC_EYROLE" AS "_BIC_EYROLE",
          tsttyp_5."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
          tsttyp_5.CALDAY AS CALDAY,
          tsttyp_5."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
          tsttyp_5."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
          tsttyp_5."_BIC_EYPATAG" AS "_BIC_EYPATAG",
          tsttyp_5."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
          tsttyp_5."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          tsttyp_5.EYSAMDT_DT AS EYSAMDT_DT,
          ROW_NUMBER() OVER (PARTITION BY tsttyp_5."_BIC_EYPATIENT", tsttyp_5."_BIC_EYSAMDT" ORDER BY tsttyp_5."_BIC_EYPATRNO" DESC) AS RANK_COL_PT
      FROM tsttyp_5
    ) AS ranked
    WHERE RANK_COL_PT <= 10
  ),
  rank_pthlgy_6 AS (
    SELECT * FROM (
      SELECT
          tsttyp_6."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          tsttyp_6."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          tsttyp_6."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
          tsttyp_6."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          tsttyp_6."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          tsttyp_6."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
          tsttyp_6."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
          tsttyp_6."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
          tsttyp_6."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          tsttyp_6."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
          tsttyp_6."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          tsttyp_6."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
          tsttyp_6."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
          tsttyp_6."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          tsttyp_6."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          tsttyp_6."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
          tsttyp_6."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          tsttyp_6."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          tsttyp_6."_BIC_EYREPMET" AS "_BIC_EYREPMET",
          tsttyp_6."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
          tsttyp_6."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
          tsttyp_6."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          tsttyp_6."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
          tsttyp_6."_BIC_EYORECNM" AS "_BIC_EYORECNM",
          tsttyp_6."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
          tsttyp_6."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
          tsttyp_6."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
          tsttyp_6."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          tsttyp_6."_BIC_EYODANTM" AS "_BIC_EYODANTM",
          tsttyp_6."_BIC_EYORIGN" AS "_BIC_EYORIGN",
          tsttyp_6."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
          tsttyp_6."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
          tsttyp_6."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
          tsttyp_6."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
          tsttyp_6."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          tsttyp_6."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
          tsttyp_6."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
          tsttyp_6.EMPLGROUP AS EMPLGROUP,
          tsttyp_6.EMPLSGROUP AS EMPLSGROUP,
          tsttyp_6."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
          tsttyp_6.ORGUNIT AS ORGUNIT,
          tsttyp_6."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
          tsttyp_6."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
          tsttyp_6.EMPLOYEE AS EMPLOYEE,
          tsttyp_6."_BIC_EYROLE" AS "_BIC_EYROLE",
          tsttyp_6."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
          tsttyp_6.CALDAY AS CALDAY,
          tsttyp_6."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
          tsttyp_6."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
          tsttyp_6."_BIC_EYPATAG" AS "_BIC_EYPATAG",
          tsttyp_6."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
          tsttyp_6."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          tsttyp_6.EYSAMDT_DT AS EYSAMDT_DT,
          ROW_NUMBER() OVER (PARTITION BY tsttyp_6."_BIC_EYPATIENT", tsttyp_6."_BIC_EYSAMDT" ORDER BY tsttyp_6."_BIC_EYPATRNO" DESC) AS RANK_COL_PT
      FROM tsttyp_6
    ) AS ranked
    WHERE RANK_COL_PT <= 10
  ),
  rank_pthlgy_7 AS (
    SELECT * FROM (
      SELECT
          tsttyp_7."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          tsttyp_7."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          tsttyp_7."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
          tsttyp_7."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          tsttyp_7."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          tsttyp_7."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
          tsttyp_7."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
          tsttyp_7."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
          tsttyp_7."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          tsttyp_7."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
          tsttyp_7."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          tsttyp_7."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
          tsttyp_7."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
          tsttyp_7."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          tsttyp_7."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          tsttyp_7."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
          tsttyp_7."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          tsttyp_7."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          tsttyp_7."_BIC_EYREPMET" AS "_BIC_EYREPMET",
          tsttyp_7."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
          tsttyp_7."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
          tsttyp_7."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          tsttyp_7."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
          tsttyp_7."_BIC_EYORECNM" AS "_BIC_EYORECNM",
          tsttyp_7."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
          tsttyp_7."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
          tsttyp_7."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
          tsttyp_7."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          tsttyp_7."_BIC_EYODANTM" AS "_BIC_EYODANTM",
          tsttyp_7."_BIC_EYORIGN" AS "_BIC_EYORIGN",
          tsttyp_7."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
          tsttyp_7."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
          tsttyp_7."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
          tsttyp_7."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
          tsttyp_7."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          tsttyp_7."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
          tsttyp_7."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
          tsttyp_7.EMPLGROUP AS EMPLGROUP,
          tsttyp_7.EMPLSGROUP AS EMPLSGROUP,
          tsttyp_7."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
          tsttyp_7.ORGUNIT AS ORGUNIT,
          tsttyp_7."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
          tsttyp_7."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
          tsttyp_7.EMPLOYEE AS EMPLOYEE,
          tsttyp_7."_BIC_EYROLE" AS "_BIC_EYROLE",
          tsttyp_7."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
          tsttyp_7.CALDAY AS CALDAY,
          tsttyp_7."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
          tsttyp_7."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
          tsttyp_7."_BIC_EYPATAG" AS "_BIC_EYPATAG",
          tsttyp_7."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
          tsttyp_7."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          tsttyp_7.EYSAMDT_DT AS EYSAMDT_DT,
          ROW_NUMBER() OVER (PARTITION BY tsttyp_7."_BIC_EYPATIENT", tsttyp_7."_BIC_EYSAMDT" ORDER BY tsttyp_7."_BIC_EYPATRNO" DESC) AS RANK_COL_PT
      FROM tsttyp_7
    ) AS ranked
    WHERE RANK_COL_PT <= 10
  ),
  rank_1 AS (
    SELECT * FROM (
      SELECT
          aggregation_1.EY_CTLT1 AS EY_CTLT1,
          aggregation_1."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          aggregation_1.CALDAY AS CALDAY,
          aggregation_1."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          aggregation_1."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          aggregation_1."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          aggregation_1."_BIC_EYRULCD" AS "_BIC_EYRULCD",
          ROW_NUMBER() OVER (PARTITION BY aggregation_1."_BIC_EYMEMIDC", aggregation_1."_BIC_EYPATIENT", aggregation_1.CALDAY, aggregation_1."_BIC_EYRULCD", aggregation_1.EY_CTLT1 ORDER BY aggregation_1."_BIC_EYEVNTID" ASC) AS RANK_COLUMN
      FROM aggregation_1
    ) AS ranked
    WHERE RANK_COLUMN <= 10
  ),
  union_all_types AS (
    SELECT
        rank_pthlgy_1.RANK_COL_PT AS RANK_COLUMN,
        rank_pthlgy_1."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        rank_pthlgy_1."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        rank_pthlgy_1."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        rank_pthlgy_1."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_pthlgy_1."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_pthlgy_1."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        rank_pthlgy_1."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        rank_pthlgy_1."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        rank_pthlgy_1."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        rank_pthlgy_1."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        rank_pthlgy_1."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        rank_pthlgy_1."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        rank_pthlgy_1."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        rank_pthlgy_1."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        rank_pthlgy_1."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        rank_pthlgy_1."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        rank_pthlgy_1."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        rank_pthlgy_1."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        rank_pthlgy_1."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        rank_pthlgy_1."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        rank_pthlgy_1."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        rank_pthlgy_1."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        rank_pthlgy_1."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        rank_pthlgy_1."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        rank_pthlgy_1."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        rank_pthlgy_1."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        rank_pthlgy_1."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        rank_pthlgy_1."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        rank_pthlgy_1."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        rank_pthlgy_1."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        rank_pthlgy_1."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        rank_pthlgy_1."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        rank_pthlgy_1."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        rank_pthlgy_1."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        rank_pthlgy_1."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_pthlgy_1."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        rank_pthlgy_1."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        rank_pthlgy_1.EMPLGROUP AS EMPLGROUP,
        rank_pthlgy_1.EMPLSGROUP AS EMPLSGROUP,
        rank_pthlgy_1."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        rank_pthlgy_1.ORGUNIT AS ORGUNIT,
        rank_pthlgy_1."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        rank_pthlgy_1."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        rank_pthlgy_1.EMPLOYEE AS EMPLOYEE,
        rank_pthlgy_1."_BIC_EYROLE" AS "_BIC_EYROLE",
        rank_pthlgy_1."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        rank_pthlgy_1.CALDAY AS CALDAY,
        rank_pthlgy_1."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        rank_pthlgy_1."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        rank_pthlgy_1."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        rank_pthlgy_1."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        rank_pthlgy_1."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_pthlgy_1.EYSAMDT_DT AS EYSAMDT_DT
    FROM rank_pthlgy_1
    UNION ALL
    SELECT
        rank_pthlgy_2.RANK_COL_PT AS RANK_COLUMN,
        rank_pthlgy_2."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        rank_pthlgy_2."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        rank_pthlgy_2."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        rank_pthlgy_2."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_pthlgy_2."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_pthlgy_2."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        rank_pthlgy_2."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        rank_pthlgy_2."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        rank_pthlgy_2."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        rank_pthlgy_2."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        rank_pthlgy_2."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        rank_pthlgy_2."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        rank_pthlgy_2."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        rank_pthlgy_2."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        rank_pthlgy_2."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        rank_pthlgy_2."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        rank_pthlgy_2."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        rank_pthlgy_2."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        rank_pthlgy_2."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        rank_pthlgy_2."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        rank_pthlgy_2."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        rank_pthlgy_2."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        rank_pthlgy_2."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        rank_pthlgy_2."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        rank_pthlgy_2."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        rank_pthlgy_2."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        rank_pthlgy_2."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        rank_pthlgy_2."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        rank_pthlgy_2."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        rank_pthlgy_2."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        rank_pthlgy_2."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        rank_pthlgy_2."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        rank_pthlgy_2."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        rank_pthlgy_2."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        rank_pthlgy_2."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_pthlgy_2."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        rank_pthlgy_2."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        rank_pthlgy_2.EMPLGROUP AS EMPLGROUP,
        rank_pthlgy_2.EMPLSGROUP AS EMPLSGROUP,
        rank_pthlgy_2."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        rank_pthlgy_2.ORGUNIT AS ORGUNIT,
        rank_pthlgy_2."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        rank_pthlgy_2."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        rank_pthlgy_2.EMPLOYEE AS EMPLOYEE,
        rank_pthlgy_2."_BIC_EYROLE" AS "_BIC_EYROLE",
        rank_pthlgy_2."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        rank_pthlgy_2.CALDAY AS CALDAY,
        rank_pthlgy_2."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        rank_pthlgy_2."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        rank_pthlgy_2."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        rank_pthlgy_2."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        rank_pthlgy_2."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_pthlgy_2.EYSAMDT_DT AS EYSAMDT_DT
    FROM rank_pthlgy_2
    UNION ALL
    SELECT
        rank_pthlgy_3.RANK_COL_PT AS RANK_COLUMN,
        rank_pthlgy_3."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        rank_pthlgy_3."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        rank_pthlgy_3."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        rank_pthlgy_3."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_pthlgy_3."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_pthlgy_3."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        rank_pthlgy_3."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        rank_pthlgy_3."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        rank_pthlgy_3."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        rank_pthlgy_3."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        rank_pthlgy_3."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        rank_pthlgy_3."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        rank_pthlgy_3."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        rank_pthlgy_3."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        rank_pthlgy_3."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        rank_pthlgy_3."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        rank_pthlgy_3."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        rank_pthlgy_3."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        rank_pthlgy_3."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        rank_pthlgy_3."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        rank_pthlgy_3."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        rank_pthlgy_3."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        rank_pthlgy_3."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        rank_pthlgy_3."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        rank_pthlgy_3."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        rank_pthlgy_3."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        rank_pthlgy_3."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        rank_pthlgy_3."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        rank_pthlgy_3."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        rank_pthlgy_3."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        rank_pthlgy_3."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        rank_pthlgy_3."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        rank_pthlgy_3."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        rank_pthlgy_3."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        rank_pthlgy_3."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_pthlgy_3."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        rank_pthlgy_3."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        rank_pthlgy_3.EMPLGROUP AS EMPLGROUP,
        rank_pthlgy_3.EMPLSGROUP AS EMPLSGROUP,
        rank_pthlgy_3."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        rank_pthlgy_3.ORGUNIT AS ORGUNIT,
        rank_pthlgy_3."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        rank_pthlgy_3."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        rank_pthlgy_3.EMPLOYEE AS EMPLOYEE,
        rank_pthlgy_3."_BIC_EYROLE" AS "_BIC_EYROLE",
        rank_pthlgy_3."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        rank_pthlgy_3.CALDAY AS CALDAY,
        rank_pthlgy_3."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        rank_pthlgy_3."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        rank_pthlgy_3."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        rank_pthlgy_3."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        rank_pthlgy_3."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_pthlgy_3.EYSAMDT_DT AS EYSAMDT_DT
    FROM rank_pthlgy_3
    UNION ALL
    SELECT
        rank_pthlgy_4.RANK_COL_PT AS RANK_COLUMN,
        rank_pthlgy_4."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        rank_pthlgy_4."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        rank_pthlgy_4."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        rank_pthlgy_4."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_pthlgy_4."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_pthlgy_4."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        rank_pthlgy_4."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        rank_pthlgy_4."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        rank_pthlgy_4."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        rank_pthlgy_4."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        rank_pthlgy_4."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        rank_pthlgy_4."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        rank_pthlgy_4."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        rank_pthlgy_4."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        rank_pthlgy_4."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        rank_pthlgy_4."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        rank_pthlgy_4."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        rank_pthlgy_4."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        rank_pthlgy_4."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        rank_pthlgy_4."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        rank_pthlgy_4."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        rank_pthlgy_4."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        rank_pthlgy_4."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        rank_pthlgy_4."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        rank_pthlgy_4."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        rank_pthlgy_4."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        rank_pthlgy_4."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        rank_pthlgy_4."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        rank_pthlgy_4."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        rank_pthlgy_4."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        rank_pthlgy_4."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        rank_pthlgy_4."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        rank_pthlgy_4."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        rank_pthlgy_4."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        rank_pthlgy_4."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_pthlgy_4."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        rank_pthlgy_4."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        rank_pthlgy_4.EMPLGROUP AS EMPLGROUP,
        rank_pthlgy_4.EMPLSGROUP AS EMPLSGROUP,
        rank_pthlgy_4."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        rank_pthlgy_4.ORGUNIT AS ORGUNIT,
        rank_pthlgy_4."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        rank_pthlgy_4."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        rank_pthlgy_4.EMPLOYEE AS EMPLOYEE,
        rank_pthlgy_4."_BIC_EYROLE" AS "_BIC_EYROLE",
        rank_pthlgy_4."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        rank_pthlgy_4.CALDAY AS CALDAY,
        rank_pthlgy_4."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        rank_pthlgy_4."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        rank_pthlgy_4."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        rank_pthlgy_4."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        rank_pthlgy_4."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_pthlgy_4.EYSAMDT_DT AS EYSAMDT_DT
    FROM rank_pthlgy_4
    UNION ALL
    SELECT
        rank_pthlgy_5.RANK_COL_PT AS RANK_COLUMN,
        rank_pthlgy_5."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        rank_pthlgy_5."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        rank_pthlgy_5."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        rank_pthlgy_5."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_pthlgy_5."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_pthlgy_5."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        rank_pthlgy_5."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        rank_pthlgy_5."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        rank_pthlgy_5."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        rank_pthlgy_5."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        rank_pthlgy_5."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        rank_pthlgy_5."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        rank_pthlgy_5."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        rank_pthlgy_5."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        rank_pthlgy_5."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        rank_pthlgy_5."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        rank_pthlgy_5."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        rank_pthlgy_5."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        rank_pthlgy_5."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        rank_pthlgy_5."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        rank_pthlgy_5."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        rank_pthlgy_5."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        rank_pthlgy_5."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        rank_pthlgy_5."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        rank_pthlgy_5."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        rank_pthlgy_5."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        rank_pthlgy_5."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        rank_pthlgy_5."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        rank_pthlgy_5."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        rank_pthlgy_5."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        rank_pthlgy_5."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        rank_pthlgy_5."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        rank_pthlgy_5."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        rank_pthlgy_5."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        rank_pthlgy_5."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_pthlgy_5."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        rank_pthlgy_5."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        rank_pthlgy_5.EMPLGROUP AS EMPLGROUP,
        rank_pthlgy_5.EMPLSGROUP AS EMPLSGROUP,
        rank_pthlgy_5."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        rank_pthlgy_5.ORGUNIT AS ORGUNIT,
        rank_pthlgy_5."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        rank_pthlgy_5."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        rank_pthlgy_5.EMPLOYEE AS EMPLOYEE,
        rank_pthlgy_5."_BIC_EYROLE" AS "_BIC_EYROLE",
        rank_pthlgy_5."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        rank_pthlgy_5.CALDAY AS CALDAY,
        rank_pthlgy_5."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        rank_pthlgy_5."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        rank_pthlgy_5."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        rank_pthlgy_5."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        rank_pthlgy_5."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_pthlgy_5.EYSAMDT_DT AS EYSAMDT_DT
    FROM rank_pthlgy_5
    UNION ALL
    SELECT
        rank_pthlgy_6.RANK_COL_PT AS RANK_COLUMN,
        rank_pthlgy_6."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        rank_pthlgy_6."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        rank_pthlgy_6."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        rank_pthlgy_6."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_pthlgy_6."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_pthlgy_6."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        rank_pthlgy_6."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        rank_pthlgy_6."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        rank_pthlgy_6."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        rank_pthlgy_6."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        rank_pthlgy_6."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        rank_pthlgy_6."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        rank_pthlgy_6."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        rank_pthlgy_6."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        rank_pthlgy_6."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        rank_pthlgy_6."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        rank_pthlgy_6."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        rank_pthlgy_6."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        rank_pthlgy_6."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        rank_pthlgy_6."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        rank_pthlgy_6."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        rank_pthlgy_6."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        rank_pthlgy_6."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        rank_pthlgy_6."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        rank_pthlgy_6."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        rank_pthlgy_6."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        rank_pthlgy_6."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        rank_pthlgy_6."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        rank_pthlgy_6."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        rank_pthlgy_6."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        rank_pthlgy_6."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        rank_pthlgy_6."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        rank_pthlgy_6."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        rank_pthlgy_6."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        rank_pthlgy_6."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_pthlgy_6."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        rank_pthlgy_6."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        rank_pthlgy_6.EMPLGROUP AS EMPLGROUP,
        rank_pthlgy_6.EMPLSGROUP AS EMPLSGROUP,
        rank_pthlgy_6."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        rank_pthlgy_6.ORGUNIT AS ORGUNIT,
        rank_pthlgy_6."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        rank_pthlgy_6."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        rank_pthlgy_6.EMPLOYEE AS EMPLOYEE,
        rank_pthlgy_6."_BIC_EYROLE" AS "_BIC_EYROLE",
        rank_pthlgy_6."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        rank_pthlgy_6.CALDAY AS CALDAY,
        rank_pthlgy_6."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        rank_pthlgy_6."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        rank_pthlgy_6."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        rank_pthlgy_6."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        rank_pthlgy_6."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_pthlgy_6.EYSAMDT_DT AS EYSAMDT_DT
    FROM rank_pthlgy_6
    UNION ALL
    SELECT
        rank_pthlgy_7.RANK_COL_PT AS RANK_COLUMN,
        rank_pthlgy_7."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        rank_pthlgy_7."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        rank_pthlgy_7."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        rank_pthlgy_7."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_pthlgy_7."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_pthlgy_7."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        rank_pthlgy_7."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        rank_pthlgy_7."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        rank_pthlgy_7."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        rank_pthlgy_7."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        rank_pthlgy_7."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        rank_pthlgy_7."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        rank_pthlgy_7."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        rank_pthlgy_7."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        rank_pthlgy_7."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        rank_pthlgy_7."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        rank_pthlgy_7."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        rank_pthlgy_7."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        rank_pthlgy_7."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        rank_pthlgy_7."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        rank_pthlgy_7."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        rank_pthlgy_7."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        rank_pthlgy_7."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        rank_pthlgy_7."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        rank_pthlgy_7."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        rank_pthlgy_7."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        rank_pthlgy_7."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        rank_pthlgy_7."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        rank_pthlgy_7."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        rank_pthlgy_7."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        rank_pthlgy_7."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        rank_pthlgy_7."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        rank_pthlgy_7."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        rank_pthlgy_7."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        rank_pthlgy_7."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_pthlgy_7."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        rank_pthlgy_7."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        rank_pthlgy_7.EMPLGROUP AS EMPLGROUP,
        rank_pthlgy_7.EMPLSGROUP AS EMPLSGROUP,
        rank_pthlgy_7."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        rank_pthlgy_7.ORGUNIT AS ORGUNIT,
        rank_pthlgy_7."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        rank_pthlgy_7."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        rank_pthlgy_7.EMPLOYEE AS EMPLOYEE,
        rank_pthlgy_7."_BIC_EYROLE" AS "_BIC_EYROLE",
        rank_pthlgy_7."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        rank_pthlgy_7.CALDAY AS CALDAY,
        rank_pthlgy_7."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        rank_pthlgy_7."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        rank_pthlgy_7."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        rank_pthlgy_7."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        rank_pthlgy_7."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_pthlgy_7.EYSAMDT_DT AS EYSAMDT_DT
    FROM rank_pthlgy_7
  ),
  projection_3 AS (
    SELECT
        rank_1.RANK_COLUMN AS RANK_COLUMN,
        rank_1.EY_CTLT1 AS EY_CTLT1,
        rank_1."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_1."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_1.CALDAY AS CALDAY,
        rank_1."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_1."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_1."_BIC_EYRULCD" AS "_BIC_EYRULCD",
        rank_1.RANK_COLUMN AS RANK_COLUMN_1,
        rank_1.RANK_COLUMN AS RANK_COL_CT
    FROM rank_1
  ),
  projection_5 AS (
    SELECT
        union_all_types.RANK_COLUMN AS RANK_COL_PT,
        union_all_types."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        union_all_types."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        union_all_types."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        union_all_types."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        union_all_types."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        union_all_types."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        union_all_types."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        union_all_types."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        union_all_types."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        union_all_types."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        union_all_types."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        union_all_types."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        union_all_types."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        union_all_types."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        union_all_types."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        union_all_types."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        union_all_types."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        union_all_types."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        union_all_types."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        union_all_types."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        union_all_types."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        union_all_types."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        union_all_types."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        union_all_types."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        union_all_types."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        union_all_types."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        union_all_types."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        union_all_types."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        union_all_types."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        union_all_types."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        union_all_types."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        union_all_types."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        union_all_types."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        union_all_types."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        union_all_types."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        union_all_types."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        union_all_types."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        union_all_types.EMPLGROUP AS EMPLGROUP,
        union_all_types.EMPLSGROUP AS EMPLSGROUP,
        union_all_types."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        union_all_types.ORGUNIT AS ORGUNIT,
        union_all_types."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        union_all_types."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        union_all_types.EMPLOYEE AS EMPLOYEE,
        union_all_types."_BIC_EYROLE" AS "_BIC_EYROLE",
        union_all_types."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        union_all_types."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        union_all_types."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        union_all_types."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        union_all_types."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        union_all_types."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        union_all_types.EYSAMDT_DT AS EYSAMDT_DT,
        (ADD_DAYS(TO_DATE(union_all_types."_BIC_EYSAMDT"),-3)) AS DATEMINUS,
        (ADD_DAYS(TO_DATE(union_all_types."_BIC_EYSAMDT"),5)) AS DATEPLUS
    FROM union_all_types
    WHERE (( (("_BIC_EYEVNTID") IS NULL) or "_BIC_EYEVNTID" = ''))
  ),
  join_1 AS (
    SELECT
        projection_5.RANK_COL_PT AS RANK_COLUMN,
        projection_5."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        projection_5."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        projection_5."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        projection_5."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        projection_5."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        projection_5."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        projection_5."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        projection_5."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        projection_5."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        projection_5."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        projection_5."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        projection_5."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        projection_5."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        projection_5."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        projection_5."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        projection_5."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        projection_5."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        projection_5."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        projection_5."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        projection_5."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        projection_5."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        projection_5."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        projection_5."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        projection_5."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        projection_5."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        projection_5."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        projection_5."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        projection_5."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        projection_5."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        projection_5."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        projection_5."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        projection_5."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        projection_5."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        projection_5."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        projection_5."_BIC_EYEVNTID" AS "_BIC_EYEVNTID_1",
        projection_5."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        projection_5."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        projection_5.EMPLGROUP AS EMPLGROUP,
        projection_5.EMPLSGROUP AS EMPLSGROUP,
        projection_5."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        projection_5.ORGUNIT AS ORGUNIT,
        projection_5."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        projection_5."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        projection_5.EMPLOYEE AS EMPLOYEE,
        projection_5."_BIC_EYROLE" AS "_BIC_EYROLE",
        projection_5."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        projection_5."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        projection_5."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        projection_5."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        projection_5."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        projection_5."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        projection_5.EYSAMDT_DT AS EYSAMDT_DT,
        projection_5.DATEMINUS AS DATEMINUS,
        projection_5.DATEPLUS AS DATEPLUS,
        projection_3.RANK_COL_CT AS RANK_COL_CT,
        projection_3.EY_CTLT1 AS EY_CTLT1,
        projection_3."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        projection_3.CALDAY AS CALDAY,
        DAYS_BETWEEN(TO_DATE("CALDAY"), TO_DATE("_BIC_EYSAMDT")) AS DATEDIFF,
        TO_VARCHAR("RANK_COLUMN") AS RANK_COL_PT
    FROM projection_5
    INNER JOIN projection_3 ON projection_5."_BIC_EYTDOCID" = projection_3."_BIC_EYTDOCID" AND projection_5."_BIC_EYMEMIDC" = projection_3."_BIC_EYMEMIDC" AND projection_5."_BIC_EYPATIENT" = projection_3."_BIC_EYPATIENT" AND projection_5.RANK_COL_PT = projection_3.RANK_COLUMN
  ),
  projection_2 AS (
    SELECT
        join_1.DATEDIFF AS DATEDIFF,
        join_1.RANK_COL_CT AS RANK_COL,
        join_1.RANK_COL_PT AS RANK_COL_PT,
        join_1.EY_CTLT1 AS EY_CTLT1,
        join_1."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        join_1.CALDAY AS CALDAY,
        join_1.RANK_COLUMN AS RANK_COLUMN,
        join_1."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        join_1."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        join_1."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        join_1."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        join_1."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        join_1."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        join_1."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        join_1."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        join_1."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        join_1."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        join_1."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        join_1."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        join_1."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        join_1."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        join_1."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        join_1."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        join_1."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        join_1."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        join_1."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        join_1."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        join_1."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        join_1."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        join_1."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        join_1."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        join_1."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        join_1."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        join_1."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        join_1."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        join_1."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        join_1."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        join_1."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        join_1."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        join_1."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        join_1."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        join_1."_BIC_EYEVNTID_1" AS "_BIC_EYEVNTID_1",
        join_1."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        join_1."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        join_1.EMPLGROUP AS EMPLGROUP,
        join_1.EMPLSGROUP AS EMPLSGROUP,
        join_1."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        join_1.ORGUNIT AS ORGUNIT,
        join_1."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        join_1."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        join_1.EMPLOYEE AS EMPLOYEE,
        join_1."_BIC_EYROLE" AS "_BIC_EYROLE",
        join_1."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        join_1."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        join_1."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        join_1."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        join_1."_BIC_EYPATAGC" AS "_BIC_EYPATAGC",
        join_1."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        join_1.EYSAMDT_DT AS EYSAMDT_DT,
        join_1.DATEMINUS AS DATEMINUS,
        join_1.DATEPLUS AS DATEPLUS,
        TO_VARCHAR(join_1.RANK_COL_PT) + TO_VARCHAR(abs(TO_INTEGER(join_1.DATEDIFF))) AS RANK_CALC_D,
        TO_INTEGER(join_1.DATEDIFF) AS DATE_DIFF_N
    FROM join_1
    WHERE ("CALDAY">="DATEMINUS"AND "CALDAY"<="DATEPLUS"AND ((not (("_BIC_EYEVNTID") IS NULL)) or "_BIC_EYEVNTID" != ''))
  ),
  rank_2 AS (
    SELECT * FROM (
      SELECT
          projection_2.RANK_COL AS RANK_COL_CT,
          projection_2.RANK_CALC_D AS RANK_CALC_D,
          projection_2.EY_CTLT1 AS EY_CTLT1,
          projection_2."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
          projection_2.CALDAY AS CALDAY,
          projection_2.DATE_DIFF_N AS DATE_DIFF_N,
          projection_2.RANK_COLUMN AS RANK_COLUMN,
          projection_2."_BIC_EYILABNO" AS "_BIC_EYILABNO",
          projection_2."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
          projection_2."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
          projection_2."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
          projection_2."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
          projection_2."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
          projection_2."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
          projection_2."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
          projection_2."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
          projection_2."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
          projection_2."_BIC_EYANSDT" AS "_BIC_EYANSDT",
          projection_2."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
          projection_2."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
          projection_2."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
          projection_2."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
          projection_2."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
          projection_2."_BIC_EYPATREV" AS "_BIC_EYPATREV",
          projection_2."_BIC_EYREPDT" AS "_BIC_EYREPDT",
          projection_2."_BIC_EYREPMET" AS "_BIC_EYREPMET",
          projection_2."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
          projection_2."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
          projection_2."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
          projection_2."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
          projection_2."_BIC_EYORECNM" AS "_BIC_EYORECNM",
          projection_2."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
          projection_2."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
          projection_2."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
          projection_2."_BIC_EYODANDT" AS "_BIC_EYODANDT",
          projection_2."_BIC_EYODANTM" AS "_BIC_EYODANTM",
          projection_2."_BIC_EYORIGN" AS "_BIC_EYORIGN",
          projection_2."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
          projection_2."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
          projection_2."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
          projection_2."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
          projection_2."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
          projection_2.EYSAMDT_DT AS EYSAMDT_DT,
          projection_2.DATEMINUS AS DATEMINUS,
          projection_2.DATEPLUS AS DATEPLUS,
          projection_2.RANK_COL_PT AS RANK_COL_PT,
          projection_2.DATEDIFF AS DATEDIFF,
          ROW_NUMBER() OVER (PARTITION BY projection_2."_BIC_EYPATIENT", projection_2."_BIC_EYPATRNO", projection_2."_BIC_EYTSTTYP" ORDER BY projection_2.RANK_CALC_D ASC) AS RANK_COLUMN_2
      FROM projection_2
    ) AS ranked
    WHERE RANK_COLUMN_2 <= 1
  ),
  union_1 AS (
    SELECT
        rank_2.RANK_CALC_D AS RANK_CALC_D,
        rank_2.EY_CTLT1 AS EY_CTLT1,
        rank_2."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_2.CALDAY AS CALDAY,
        rank_2.DATE_DIFF_N AS DATE_DIFF_N,
        rank_2.RANK_COLUMN AS RANK_COLUMN,
        rank_2."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        rank_2."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        rank_2."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        rank_2."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        rank_2."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        rank_2."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        rank_2."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        rank_2."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        rank_2."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        rank_2."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        rank_2."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        rank_2."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        rank_2."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        rank_2."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        rank_2."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        rank_2."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        rank_2."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        rank_2."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        rank_2."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        rank_2."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        rank_2."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        rank_2."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        rank_2."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        rank_2."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        rank_2."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        rank_2."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        rank_2."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        rank_2."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        rank_2."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        rank_2."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        rank_2."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        rank_2."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        rank_2."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        rank_2."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        rank_2."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        rank_2.EYSAMDT_DT AS EYSAMDT_DT,
        rank_2.DATEMINUS AS DATEMINUS,
        rank_2.DATEPLUS AS DATEPLUS,
        rank_2.RANK_COL_CT AS RANK_COL_CT,
        rank_2.RANK_COL_PT AS RANK_COL_PT,
        rank_2.DATEDIFF AS DATEDIFF,
        NULL AS "_BIC_EZCLINSIS",
        NULL AS "_BIC_EYDOCPOS",
        NULL AS EMPLGROUP,
        NULL AS EMPLSGROUP,
        NULL AS "_BIC_EYPOSPER",
        NULL AS ORGUNIT,
        NULL AS "_BIC_EYFACTYP",
        NULL AS "_BIC_EYFACSTYP",
        NULL AS EMPLOYEE,
        NULL AS "_BIC_EYROLE",
        NULL AS "_BIC_EYROLEGRP",
        NULL AS "_BIC_EYOPRFCLT",
        NULL AS "_BIC_EYFACOWNR",
        NULL AS "_BIC_EYPATAG",
        NULL AS "_BIC_EYPATAGC"
    FROM rank_2
    UNION ALL
    SELECT
        NULL AS RANK_CALC_D,
        NULL AS EY_CTLT1,
        join_2."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        join_2.CALDAY AS CALDAY,
        NULL AS DATE_DIFF_N,
        NULL AS RANK_COLUMN,
        NULL AS "_BIC_EYILABNO",
        NULL AS "_BIC_EYPATRNO",
        NULL AS "_BIC_EYTMEMID",
        NULL AS "_BIC_EYMEMIDC",
        NULL AS "_BIC_EYTDOCID",
        NULL AS "_BIC_EYOPDLIC",
        NULL AS "_BIC_EYMAFDID",
        NULL AS "_BIC_EYDOCLIC",
        NULL AS "_BIC_EYSAMDT",
        NULL AS "_BIC_EYCOLCDT",
        NULL AS "_BIC_EYANSDT",
        NULL AS "_BIC_EYTSTTYP",
        NULL AS "_BIC_EYPDFPTH",
        NULL AS "_BIC_EYMALIGN",
        NULL AS "_BIC_EYTDRDAN",
        NULL AS "_BIC_EYODRDAN",
        NULL AS "_BIC_EYPATREV",
        NULL AS "_BIC_EYREPDT",
        NULL AS "_BIC_EYREPMET",
        NULL AS "_BIC_EYRECNAM",
        NULL AS "_BIC_EYCOMMNT",
        NULL AS "_BIC_EYOREPDT",
        NULL AS "_BIC_EYOREPMT",
        NULL AS "_BIC_EYORECNM",
        NULL AS "_BIC_EYOCOMNT",
        NULL AS "_BIC_EYTDANDT",
        NULL AS "_BIC_EYTDANTM",
        NULL AS "_BIC_EYODANDT",
        NULL AS "_BIC_EYODANTM",
        NULL AS "_BIC_EYORIGN",
        NULL AS "_BIC_EYMSNOM",
        NULL AS "_BIC_EYTSNOM",
        NULL AS "_BIC_EYCREATDT",
        NULL AS "_BIC_EYCREATTM",
        NULL AS "_BIC_EYPATIENT",
        NULL AS EYSAMDT_DT,
        NULL AS DATEMINUS,
        NULL AS DATEPLUS,
        NULL AS RANK_COL_CT,
        NULL AS RANK_COL_PT,
        NULL AS DATEDIFF,
        join_2."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        join_2."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        join_2.EMPLGROUP AS EMPLGROUP,
        join_2.EMPLSGROUP AS EMPLSGROUP,
        join_2."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        join_2.ORGUNIT AS ORGUNIT,
        join_2."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        join_2."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        join_2.EMPLOYEE AS EMPLOYEE,
        join_2."_BIC_EYROLE" AS "_BIC_EYROLE",
        join_2."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        join_2."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        join_2."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        join_2."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        join_2."_BIC_EYPATAGC" AS "_BIC_EYPATAGC"
    FROM join_2
  ),
  join_3 AS (
    SELECT
        union_1.RANK_CALC_D AS RANK_CALC_D,
        union_1.EY_CTLT1 AS EY_CTLT1,
        union_1.DATE_DIFF_N AS DATE_DIFF_N,
        union_1.RANK_COLUMN AS RANK_COLUMN,
        union_1."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        union_1."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        union_1."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        union_1."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        union_1."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        union_1."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        union_1."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        union_1."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        union_1."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        union_1."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        union_1."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        union_1."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        union_1."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        union_1."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        union_1."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        union_1."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        union_1."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        union_1."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        union_1."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        union_1."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        union_1."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        union_1."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        union_1."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        union_1."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        union_1."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        union_1."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        union_1."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        union_1."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        union_1."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        union_1."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        union_1."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        union_1."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        union_1."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        union_1."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        union_1."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        union_1.EYSAMDT_DT AS EYSAMDT_DT,
        union_1.DATEMINUS AS DATEMINUS,
        union_1.DATEPLUS AS DATEPLUS,
        union_1.CALDAY AS CALDAY,
        union_1.RANK_COL_CT AS RANK_COL_CT,
        union_1.RANK_COL_PT AS RANK_COL_PT,
        rank_3."_BIC_EYFCLTY" AS "_BIC_EYFCLTY",
        rank_3.EMPLGROUP AS EMPLGROUP,
        rank_3.EMPLSGROUP AS EMPLSGROUP,
        rank_3."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        rank_3."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        rank_3."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        rank_3."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        rank_3."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        rank_3."_BIC_EYROLE" AS "_BIC_EYROLE",
        rank_3."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        rank_3."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        rank_3."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        rank_3."_BIC_EYPATAGC" AS "_BIC_EYPATAGC_1",
        rank_3."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        rank_3.EMPLOYEE AS EMPLOYEE,
        rank_3."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        rank_3.ORGUNIT AS ORGUNIT
    FROM union_1
    INNER JOIN rank_3 ON union_1.CALDAY = rank_3.CALDAY AND union_1."_BIC_EYEVNTID" = rank_3."_BIC_EYEVNTID"
  ),
  projection AS (
    SELECT
        join_3.EY_CTLT1 AS EY_CTLT1,
        join_3."_BIC_EYILABNO" AS "_BIC_EYILABNO",
        join_3."_BIC_EYPATRNO" AS "_BIC_EYPATRNO",
        join_3."_BIC_EYTMEMID" AS "_BIC_EYTMEMID",
        join_3."_BIC_EYMEMIDC" AS "_BIC_EYMEMIDC",
        join_3."_BIC_EYTDOCID" AS "_BIC_EYTDOCID",
        join_3."_BIC_EYOPDLIC" AS "_BIC_EYOPDLIC",
        join_3."_BIC_EYMAFDID" AS "_BIC_EYMAFDID",
        join_3."_BIC_EYDOCLIC" AS "_BIC_EYDOCLIC",
        join_3."_BIC_EYSAMDT" AS "_BIC_EYSAMDT",
        join_3."_BIC_EYCOLCDT" AS "_BIC_EYCOLCDT",
        join_3."_BIC_EYANSDT" AS "_BIC_EYANSDT",
        join_3."_BIC_EYTSTTYP" AS "_BIC_EYTSTTYP",
        join_3."_BIC_EYPDFPTH" AS "_BIC_EYPDFPTH",
        join_3."_BIC_EYMALIGN" AS "_BIC_EYMALIGN",
        join_3."_BIC_EYTDRDAN" AS "_BIC_EYTDRDAN",
        join_3."_BIC_EYODRDAN" AS "_BIC_EYODRDAN",
        join_3."_BIC_EYPATREV" AS "_BIC_EYPATREV",
        join_3."_BIC_EYREPDT" AS "_BIC_EYREPDT",
        join_3."_BIC_EYREPMET" AS "_BIC_EYREPMET",
        join_3."_BIC_EYRECNAM" AS "_BIC_EYRECNAM",
        join_3."_BIC_EYCOMMNT" AS "_BIC_EYCOMMNT",
        join_3."_BIC_EYOREPDT" AS "_BIC_EYOREPDT",
        join_3."_BIC_EYOREPMT" AS "_BIC_EYOREPMT",
        join_3."_BIC_EYORECNM" AS "_BIC_EYORECNM",
        join_3."_BIC_EYOCOMNT" AS "_BIC_EYOCOMNT",
        join_3."_BIC_EYTDANDT" AS "_BIC_EYTDANDT",
        join_3."_BIC_EYTDANTM" AS "_BIC_EYTDANTM",
        join_3."_BIC_EYODANDT" AS "_BIC_EYODANDT",
        join_3."_BIC_EYODANTM" AS "_BIC_EYODANTM",
        join_3."_BIC_EYORIGN" AS "_BIC_EYORIGN",
        join_3."_BIC_EYMSNOM" AS "_BIC_EYMSNOM",
        join_3."_BIC_EYTSNOM" AS "_BIC_EYTSNOM",
        join_3."_BIC_EYCREATDT" AS "_BIC_EYCREATDT",
        join_3."_BIC_EYCREATTM" AS "_BIC_EYCREATTM",
        join_3."_BIC_EYPATIENT" AS "_BIC_EYPATIENT",
        join_3.EYSAMDT_DT AS EYSAMDT_DT,
        join_3.DATEMINUS AS DATEMINUS,
        join_3.DATEPLUS AS DATEPLUS,
        join_3.CALDAY AS CALDAY,
        join_3."_BIC_EYFCLTY" AS "_BIC_EYFCLTY",
        join_3."_BIC_EYROLEGRP" AS "_BIC_EYROLEGRP",
        join_3."_BIC_EYOPRFCLT" AS "_BIC_EYOPRFCLT",
        join_3.EMPLGROUP AS EMPLGROUP,
        join_3.EMPLSGROUP AS EMPLSGROUP,
        join_3."_BIC_EYFACOWNR" AS "_BIC_EYFACOWNR",
        join_3."_BIC_EYPOSPER" AS "_BIC_EYPOSPER",
        join_3."_BIC_EYDOCPOS" AS "_BIC_EYDOCPOS",
        join_3."_BIC_EYROLE" AS "_BIC_EYROLE",
        join_3."_BIC_EYEVNTID" AS "_BIC_EYEVNTID",
        join_3."_BIC_EYFACTYP" AS "_BIC_EYFACTYP",
        join_3."_BIC_EYFACSTYP" AS "_BIC_EYFACSTYP",
        join_3."_BIC_EZCLINSIS" AS "_BIC_EZCLINSIS",
        join_3.EMPLOYEE AS EMPLOYEE,
        join_3."_BIC_EYPATAG" AS "_BIC_EYPATAG",
        join_3.ORGUNIT AS ORGUNIT,
        join_3.RANK_CALC_D AS RANK_CALC_D,
        join_3.DATE_DIFF_N AS DATE_DIFF_N,
        join_3.RANK_COLUMN AS RANK_COLUMN,
        join_3.RANK_COL_CT AS RANK_COL_CT,
        join_3.RANK_COL_PT AS RANK_COL_PT
    FROM join_3
  )

SELECT RANK_CALC_D, EY_CTLT1, DATE_DIFF_N, RANK_COLUMN, "_BIC_EYILABNO", "_BIC_EYPATRNO", "_BIC_EYTMEMID", "_BIC_EYMEMIDC", "_BIC_EYTDOCID", "_BIC_EYOPDLIC", "_BIC_EYMAFDID", "_BIC_EYDOCLIC", "_BIC_EYSAMDT", "_BIC_EYCOLCDT", "_BIC_EYANSDT", "_BIC_EYTSTTYP", "_BIC_EYPDFPTH", "_BIC_EYMALIGN", "_BIC_EYTDRDAN", "_BIC_EYODRDAN", "_BIC_EYPATREV", "_BIC_EYREPDT", "_BIC_EYREPMET", "_BIC_EYRECNAM", "_BIC_EYCOMMNT", "_BIC_EYOREPDT", "_BIC_EYOREPMT", "_BIC_EYORECNM", "_BIC_EYOCOMNT", "_BIC_EYTDANDT", "_BIC_EYTDANTM", "_BIC_EYODANDT", "_BIC_EYODANTM", "_BIC_EYORIGN", "_BIC_EYMSNOM", "_BIC_EYTSNOM", "_BIC_EYCREATDT", "_BIC_EYCREATTM", "_BIC_EYPATIENT", EYSAMDT_DT, DATEMINUS, DATEPLUS, CALDAY, "_BIC_EYFCLTY", "_BIC_EYROLEGRP", "_BIC_EYOPRFCLT", EMPLGROUP, EMPLSGROUP, "_BIC_EYFACOWNR", "_BIC_EYPOSPER", "_BIC_EYDOCPOS", "_BIC_EYROLE", "_BIC_EYEVNTID", "_BIC_EYFACTYP", "_BIC_EYFACSTYP", RANK_COL_CT, RANK_COL_PT, "_BIC_EZCLINSIS", EMPLOYEE, "_BIC_EYPATAG", ORGUNIT FROM projection